<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ‹†å¼¹ä¸“å®¶ - è§£å¯†åŠ©æ‰‹</title>
    <style>
        /* å…¨å±€æ ·å¼ */
        :root {
            --primary-color: #ef4444;
            --secondary-color: #3b82f6;
            --dark-color: #1e293b;
            --light-color: #f8fafc;
            --success-color: #22c55e;
            --warning-color: #eab308;
            --danger-color: #ef4444;
            --info-color: #0ea5e9;
            --bg-color: #0f172a;
            --text-color: #f8fafc;
            --text-secondary: #94a3b8;
            --border-color: #334155;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            min-height: 100vh;
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }

        /* æ ‡é¢˜æ ·å¼ */
        h1,
        h2,
        h3,
        h4,
        h5,
        h6 {
            font-weight: 700;
            margin-bottom: 1rem;
        }

        h1 {
            font-size: 3rem;
            text-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        h2 {
            font-size: 2rem;
        }

        h3 {
            font-size: 1.5rem;
        }

        /* å¸ƒå±€æ ·å¼ */
        .header {
            text-align: center;
            margin-bottom: 3rem;
        }

        .main-content {
            display: flex;
            gap: 2rem;
        }

        .module-nav {
            flex: 0 0 250px;
        }

        .module-content-wrapper {
            flex: 1;
        }

        /* ç»„ä»¶æ ·å¼ */
        .nav-container {
            background-color: var(--dark-color);
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.3);
        }

        .nav-title {
            color: var(--secondary-color);
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 0.75rem;
            margin-bottom: 1rem;
        }

        .nav-list {
            list-style: none;
        }

        .nav-item {
            margin-bottom: 0.5rem;
        }

        .module-tab {
            width: 100%;
            text-align: left;
            padding: 0.75rem 1rem;
            background: none;
            border: none;
            border-radius: 8px;
            color: var(--text-color);
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s ease;
        }

        .module-tab:hover:not(.disabled) {
            background-color: rgba(59, 130, 246, 0.1);
        }

        .module-tab.active {
            background-color: rgba(59, 130, 246, 0.2);
            border-left: 4px solid var(--secondary-color);
        }

        .module-tab.disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .difficulty-badge {
            font-size: 0.75rem;
            padding: 0.25rem 0.5rem;
            border-radius: 9999px;
            color: var(--dark-color);
        }

        .difficulty-easy {
            background-color: var(--warning-color);
        }

        .difficulty-medium {
            background-color: var(--warning-color);
        }

        .difficulty-hard {
            background-color: var(--success-color);
        }

        /* ç‚¸å¼¹å®¹å™¨æ ·å¼ */
        /* å•è¯åˆ—è¡¨æ ·å¼ */
        .words-list {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-top: 0.5rem;
        }

        .word-item {
            background-color: rgba(59, 130, 246, 0.1);
            color: var(--secondary-color);
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.875rem;
            transition: all 0.3s ease;
            cursor: pointer;
            border: 1px solid transparent;
        }

        .word-item:hover {
            background-color: rgba(59, 130, 246, 0.2);
            border-color: var(--secondary-color);
            transform: translateY(-2px);
        }

        .word-item.highlight {
            background-color: var(--secondary-color);
            color: white;
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
        }

        .word-item.correct-word {
            background-color: var(--success-color);
            color: white;
            animation: pulse 1s ease-in-out 3;
        }

        .bomb-container {
            background-color: var(--dark-color);
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.3);
            position: relative;
            overflow: hidden;
        }

        .bomb-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: linear-gradient(90deg, var(--primary-color), var(--warning-color), var(--success-color), var(--secondary-color), #8b5cf6);
        }

        .module-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .module-title {
            color: var(--warning-color);
            margin: 0;
        }

        .serial-input-group {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .serial-label {
            font-size: 0.875rem;
            color: var(--text-secondary);
        }

        .serial-input {
            width: 3rem;
            height: 2.5rem;
            background-color: #0f172a;
            border: 2px solid var(--warning-color);
            border-radius: 8px;
            color: var(--text-color);
            font-family: 'Courier New', monospace;
            font-size: 1.25rem;
            text-align: center;
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }

        .required-badge {
            font-size: 0.75rem;
            color: var(--warning-color);
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }

        /* çº¿è·¯å®¹å™¨æ ·å¼ */
        .wire-container {
            position: relative;
            height: 200px;
            display: flex;
            justify-content: space-around;
            align-items: flex-start;
            padding-top: 20px;
            background-color: #0f172a;
            border-radius: 8px;
            margin-bottom: 1.5rem;
        }

        .wire {
            width: 8px;
            height: 150px;
            border-radius: 4px;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
        }

        .wire:hover {
            transform: scale(1.1);
            height: 160px;
        }

        .wire.hidden {
            display: none;
        }

        .wire.cut {
            height: 50px;
            opacity: 0.5;
        }

        .wire.correct {
            animation: pulse 1s cubic-bezier(0.4, 0, 0.6, 1) 3;
        }

        .wire.incorrect {
            animation: shake 0.5s cubic-bezier(.36, .07, .19, .97) both;
        }

        .wire-red {
            background-color: var(--primary-color);
            box-shadow: 0 0 10px var(--primary-color);
        }

        .wire-yellow {
            background-color: var(--warning-color);
            box-shadow: 0 0 10px var(--warning-color);
        }

        .wire-blue {
            background-color: var(--secondary-color);
            box-shadow: 0 0 10px var(--secondary-color);
        }

        .wire-black {
            background-color: var(--dark-color);
            box-shadow: 0 0 10px var(--dark-color);
        }

        .wire-white {
            background-color: var(--light-color);
            box-shadow: 0 0 10px var(--light-color);
        }

        /* è¾“å…¥åŒºåŸŸæ ·å¼ */
        .input-section {
            margin-bottom: 1.5rem;
        }

        .input-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
        }

        .input-title {
            margin: 0;
        }

        .color-legend {
            font-size: 0.75rem;
            background-color: #0f172a;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
        }

        .color-swatch {
            display: inline-block;
            width: 0.75rem;
            height: 0.75rem;
            border-radius: 50%;
            margin: 0 0.25rem;
        }

        .color-red {
            background-color: #ef4444;
        }

        .color-yellow {
            background-color: #eab308;
        }

        .color-blue {
            background-color: #3b82f6;
        }

        .color-black {
            background-color: #1e293b;
        }

        .color-white {
            background-color: #f8fafc;
        }

        .input-container {
            position: relative;
            margin-bottom: 0.5rem;
        }

        .wire-input {
            width: 100%;
            background-color: #0f172a;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 0.75rem 2.5rem 0.75rem 0.75rem;
            font-family: 'Courier New', monospace;
            font-size: 1.125rem;
            color: var(--text-color);
        }

        .input-icon {
            position: absolute;
            right: 0.75rem;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-secondary);
        }

        .input-hint {
            font-size: 0.75rem;
            color: #64748b;
        }

        /* æ‹†é™¤æŒ‡ç¤ºæ ·å¼ */
        .instruction-section {
            margin-top: 1.5rem;
        }

        .instruction-title {
            margin-bottom: 0.75rem;
        }

        .instruction-container {
            background-color: #0f172a;
            border-radius: 8px;
            padding: 1rem;
            min-height: 120px;
            margin-bottom: 1rem;
        }

        .instruction-actions {
            display: flex;
            gap: 0.75rem;
            margin-top: 1.5rem;
        }

        .btn {
            flex: 1;
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 8px;
            color: var(--text-color);
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .btn-secondary {
            background-color: #334155;
        }

        .btn-secondary:hover {
            background-color: #475569;
        }

        .btn-primary {
            background-color: var(--secondary-color);
        }

        .btn-primary:hover {
            background-color: #2563eb;
        }

        /* æ¨¡æ€æ¡†æ ·å¼ */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 50;
            display: none;
        }

        .modal-content {
            background-color: var(--dark-color);
            border-radius: 12px;
            padding: 1.5rem;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .modal-title {
            color: var(--warning-color);
            margin: 0;
        }

        .modal-close {
            background: none;
            border: none;
            color: var(--text-secondary);
            font-size: 1.25rem;
            cursor: pointer;
            transition: color 0.3s ease;
        }

        .modal-close:hover {
            color: var(--text-color);
        }

        .rules-content {
            font-size: 0.875rem;
        }

        .rule-section {
            margin-bottom: 1rem;
        }

        .rule-title {
            color: var(--secondary-color);
            margin-bottom: 0.5rem;
        }

        .rule-list {
            list-style-type: disc;
            padding-left: 1.5rem;
        }

        .rule-item {
            margin-bottom: 0.25rem;
        }

        /* é€šç”¨è¾“å…¥ç»„æ ·å¼ */
        .input-group {
            margin-bottom: 1rem;
        }

        .input-label {
            display: block;
            font-size: 0.875rem;
            color: var(--text-secondary);
            margin-bottom: 0.5rem;
        }

        .button-group {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        .feature-btn {
            flex: 1;
            min-width: 80px;
            padding: 0.5rem 1rem;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            background-color: #0f172a;
            color: var(--text-color);
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .feature-btn:hover {
            border-color: var(--secondary-color);
            background-color: rgba(59, 130, 246, 0.1);
        }

        .feature-btn.active {
            border-color: var(--secondary-color);
            background-color: rgba(59, 130, 246, 0.2);
            color: var(--secondary-color);
        }

        /* æ¨¡å—å†…å®¹åŒºåŸŸæ ·å¼ */
        .module-content {
            display: none;
        }

        .module-content.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        /* å·¥å…·ç±» */
        .mb-4 {
            margin-bottom: 1.5rem;
        }

        /* é¡µè„šæ ·å¼ */
        .footer {
            margin-top: 3rem;
            text-align: center;
            color: #64748b;
            font-size: 0.875rem;
        }

        .letter-value {
            color: var(--warning-color);
            font-weight: bold;
        }

        .instruction-content {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .instruction-letter {
            font-size: 0.875rem;
            color: var(--text-secondary);
        }

        .instruction-text {
            font-size: 1.125rem;
            font-weight: 500;
            color: var(--text-color);
        }

        /* åŠ¨ç”» */
        @keyframes pulse {

            0%,
            100% {
                opacity: 1;
            }

            50% {
                opacity: 0.5;
            }
        }

        @keyframes shake {

            10%,
            90% {
                transform: translateX(-1px);
            }

            20%,
            80% {
                transform: translateX(2px);
            }

            30%,
            50%,
            70% {
                transform: translateX(-4px);
            }

            40%,
            60% {
                transform: translateX(4px);
            }
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* é¡ºåºçº¿è·¯æ ·å¼ */
        .sequence-buttons {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-bottom: 2rem;
            padding: 1rem;
            background-color: #0f172a;
            border-radius: 8px;
        }

        .sequence-btn {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            font-size: 1.125rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            color: white;
        }

        .sequence-btn.red {
            background-color: #ef4444;
            box-shadow: 0 4px 0 #dc2626;
        }

        .sequence-btn.blue {
            background-color: #3b82f6;
            box-shadow: 0 4px 0 #2563eb;
        }

        .sequence-btn.black {
            background-color: #1f2937;
            box-shadow: 0 4px 0 #111827;
            color: white;
        }

        .sequence-btn:hover {
            transform: translateY(-2px);
        }

        .sequence-btn:active {
            transform: translateY(0);
            box-shadow: 0 2px 0 currentColor;
        }

        .sequence-display {
            margin-bottom: 2rem;
        }

        .sequence-list {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            padding: 1rem;
            background-color: #0f172a;
            border-radius: 8px;
            min-height: 3rem;
        }

        .sequence-item {
            display: flex;
            align-items: center;
            gap: 0.25rem;
            padding: 0.5rem 0.75rem;
            border-radius: 6px;
            font-weight: 600;
            font-size: 0.875rem;
        }

        .sequence-item.red {
            background-color: rgba(239, 68, 68, 0.2);
            color: #fca5a5;
            border: 1px solid #ef4444;
        }

        .sequence-item.blue {
            background-color: rgba(59, 130, 246, 0.2);
            color: #93c5fd;
            border: 1px solid #3b82f6;
        }

        .sequence-item.black {
            background-color: rgba(31, 41, 55, 0.5);
            color: #d1d5db;
            border: 1px solid #4b5563;
        }

        .sequence-table-container {
            margin-bottom: 2rem;
            overflow-x: auto;
        }

        .sequence-table {
            width: 100%;
            border-collapse: collapse;
            background-color: #0f172a;
            border-radius: 8px;
            overflow: hidden;
        }

        .sequence-table th {
            background-color: var(--dark-color);
            color: var(--text-secondary);
            padding: 0.75rem;
            text-align: left;
            font-weight: 600;
            font-size: 0.875rem;
            border-bottom: 2px solid var(--border-color);
        }

        .sequence-table td {
            padding: 0.75rem;
            border-bottom: 1px solid var(--border-color);
            font-size: 0.875rem;
        }

        .sequence-table tr:last-child td {
            border-bottom: none;
        }

        .sequence-table tr.highlight td {
            background-color: rgba(34, 197, 94, 0.1);
            color: var(--success-color);
            font-weight: 600;
        }

        .sequence-table tr.highlight-red td:nth-child(1),
        .sequence-table tr.highlight-red td:nth-child(2) {
            background-color: rgba(239, 68, 68, 0.2);
            color: #fca5a5;
        }

        .sequence-table tr.highlight-blue td:nth-child(3),
        .sequence-table tr.highlight-blue td:nth-child(4) {
            background-color: rgba(59, 130, 246, 0.2);
            color: #93c5fd;
        }

        .sequence-table tr.highlight-black td:nth-child(5),
        .sequence-table tr.highlight-black td:nth-child(6) {
            background-color: rgba(31, 41, 55, 0.5);
            color: #d1d5db;
        }

        .sequence-instructions {
            background-color: rgba(59, 130, 246, 0.1);
            border: 1px solid var(--secondary-color);
            border-radius: 8px;
            padding: 1rem;
        }

        .instruction-text {
            margin: 0;
            color: var(--text-color);
            line-height: 1.5;
        }

        /* è®°å¿†æ¨¡å—æ ·å¼ */
        .stage-indicator {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .button-panel {
            background-color: #0f172a;
            border-radius: 8px;
            padding: 1rem;
        }

        .button-row {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 1rem;
        }

        .button-row:last-child {
            margin-bottom: 0;
        }

        .row-label {
            width: 80px;
            font-size: 0.875rem;
            color: var(--text-secondary);
        }

        .memory-btn {
            flex: 1;
            height: 50px;
            border: 3px solid var(--border-color);
            border-radius: 8px;
            background-color: #1e293b;
            color: var(--text-color);
            font-size: 1.125rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .memory-btn:hover {
            border-color: var(--secondary-color);
            background-color: rgba(59, 130, 246, 0.1);
            transform: scale(1.05);
        }

        .memory-btn.active {
            border-color: var(--success-color);
            background-color: rgba(34, 197, 94, 0.2);
            color: var(--success-color);
        }

        .memory-btn.correct {
            border-color: var(--success-color);
            background-color: rgba(34, 197, 94, 0.3);
            animation: pulse 0.5s ease;
        }

        .memory-btn.incorrect {
            border-color: var(--danger-color);
            background-color: rgba(239, 68, 68, 0.3);
            animation: shake 0.5s ease;
        }

        .memory-btn.selected {
            border-color: var(--success-color);
            background-color: rgba(34, 197, 94, 0.3);
            color: var(--success-color);
            transform: scale(1.1);
            box-shadow: 0 0 20px rgba(34, 197, 94, 0.5);
            border-width: 3px;
            font-weight: bold;
            z-index: 10;
        }

        .stage-tracker {
            background-color: #0f172a;
            border-radius: 8px;
            padding: 1rem;
        }

        .stage-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 0.75rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid var(--border-color);
            flex-wrap: wrap;
        }

        .stage-header-item {
            flex: 1;
            min-width: 40px;
            font-size: 0.75rem;
            font-weight: 600;
            color: var(--secondary-color);
            text-align: center;
            width: auto;
        }

        .stage-row {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
            flex-wrap: wrap;
        }

        .stage-row:last-child {
            margin-bottom: 0;
        }

        .stage-label {
            width: 40px;
            font-size: 0.875rem;
            color: var(--text-secondary);
            font-weight: 600;
        }

        .stage-input {
            flex: 1;
            min-width: 40px;
            height: 2.5rem;
            background-color: #1e293b;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            color: var(--text-color);
            font-size: 1rem;
            text-align: center;
            font-weight: 600;
            width: auto;
        }

        .stage-arrow {
            color: var(--secondary-color);
            font-weight: bold;
        }

        .stage-completed {
            opacity: 0.6;
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 1024px) {
            .main-content {
                flex-direction: column;
            }

            .stage-tracker {
                overflow-x: auto;
                padding: 0.75rem;
            }

            .stage-input,
            .stage-header-item {
                font-size: 0.875rem;
                padding: 0.25rem;
            }

            .module-nav {
                flex: none;
            }

            h1 {
                font-size: 2.5rem;
            }
        }

        @media (max-width: 640px) {
            .container {
                padding: 1rem;
            }

            h1 {
                font-size: 2rem;
            }

            h2 {
                font-size: 1.5rem;
            }

            .module-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 1rem;
            }

            .instruction-actions {
                flex-direction: column;
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <h1>æ‹†å¼¹ä¸“å®¶ <span style="color: var(--secondary-color);">è§£å¯†åŠ©æ‰‹</span></h1>
            <p style="color: var(--text-secondary); font-size: 1.125rem;">ä¿æŒå†·é™ï¼ŒæŒ‰ç…§æŒ‡ç¤ºæ“ä½œï¼Œä½ èƒ½æˆåŠŸæ‹†é™¤ç‚¸å¼¹ï¼</p>
        </header>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Module Navigation -->
            <div class="module-nav">
                <div class="nav-container">
                    <h2 class="nav-title">è§£å¯†æ¨¡å—</h2>
                    <nav>
                        <ul class="nav-list">
                            <li class="nav-item">
                                <button id="tab-wires" class="module-tab active" data-module="module-wires">
                                    <span>âš¡ çº¿è·¯æ¨¡å—</span>
                                    <span class="difficulty-badge difficulty-easy">ç®€å•</span>
                                </button>
                            </li>
                            <li class="nav-item">
                                <button id="tab-complex-wires" class="module-tab" data-module="module-complex-wires">
                                    <span>âš¡ å¤æ‚çº¿è·¯</span>
                                    <span class="difficulty-badge difficulty-medium">ä¸­ç­‰</span>
                                </button>
                            </li>
                            <li class="nav-item">
                                <button id="tab-password" class="module-tab" data-module="module-password">
                                    <span>âŒ¨ï¸ å¯†ç æ¨¡å—</span>
                                    <span class="difficulty-badge difficulty-hard">å›°éš¾</span>
                                </button>
                            </li>
                            <li class="nav-item">
                                <button id="tab-sequence" class="module-tab" data-module="module-sequence">
                                    <span>ğŸ”¢ é¡ºåºçº¿è·¯</span>
                                    <span class="difficulty-badge difficulty-medium">ä¸­ç­‰</span>
                                </button>
                            </li>
                            <li class="nav-item">
                                <button id="tab-memory" class="module-tab" data-module="module-memory">
                                    <span>ğŸ’¾ è®°å¿†æ¨¡å—</span>
                                    <span class="difficulty-badge difficulty-hard">å›°éš¾</span>
                                </button>
                            </li>
                        </ul>
                    </nav>
                </div>
            </div>

            <!-- Module Content -->
            <div class="module-content-wrapper">
                <!-- Wires Module -->
                <div id="module-wires" class="module-content active">
                    <div class="bomb-container">
                        <div class="module-header">
                            <h2 class="module-title">çº¿è·¯æ¨¡å—</h2>
                            <div class="serial-input-group">
                                <span class="serial-label">åºåˆ—å·æœ«ä½:</span>
                                <input type="text" id="serial-last" class="serial-input" maxlength="1" placeholder="?">
                                <span class="required-badge">*å¿…å¡«</span>
                            </div>
                        </div>

                        <!-- Wire Display -->
                        <div class="wire-container">
                            <div id="wire-1" class="wire wire-red"></div>
                            <div id="wire-2" class="wire wire-blue"></div>
                            <div id="wire-3" class="wire wire-yellow"></div>
                            <div id="wire-4" class="wire wire-black hidden"></div>
                            <div id="wire-5" class="wire wire-white hidden"></div>
                            <div id="wire-6" class="wire wire-red hidden"></div>
                        </div>

                        <!-- Input Section -->
                        <div class="input-section">
                            <div class="input-header">
                                <h3 class="input-title">çº¿è·¯è¾“å…¥</h3>
                                <div class="color-legend">
                                    <span class="color-swatch color-red"></span>1=çº¢
                                    <span class="color-swatch color-yellow"></span>2=é»„
                                    <span class="color-swatch color-blue"></span>3=è“
                                    <span class="color-swatch color-black"></span>4=é»‘
                                    <span class="color-swatch color-white"></span>5=ç™½
                                </div>
                            </div>

                            <div class="input-container">
                                <input type="text" id="wire-input" class="wire-input"
                                    placeholder="è¾“å…¥çº¿è·¯ä»£ç ï¼Œå¦‚ï¼š11324ï¼ˆè¡¨ç¤ºçº¢çº¢è“é»„é»‘ï¼‰" maxlength="6">
                                <div class="input-icon" title="è¾“å…¥3-6ä½æ•°å­—ï¼Œæ¯ä¸ªæ•°å­—ä»£è¡¨ä¸€ç§é¢œè‰²">â„¹ï¸</div>
                            </div>

                            <p class="input-hint">ç¤ºä¾‹ï¼šè¾“å…¥"11324"è¡¨ç¤º5æ ¹çº¿ï¼Œä»ä¸Šåˆ°ä¸‹ä¾æ¬¡æ˜¯ï¼šçº¢ã€çº¢ã€è“ã€é»„ã€é»‘</p>
                        </div>

                        <!-- Instruction Section -->
                        <div class="instruction-section">
                            <h3 class="instruction-title">æ‹†é™¤æŒ‡ç¤º</h3>
                            <div id="cut-instruction" class="instruction-container">
                                <p style="color: var(--text-secondary); text-align: center; font-style: italic;">
                                    è¯·è¾“å…¥çº¿è·¯ä»£ç å’Œåºåˆ—å·æœ«ä½æ•°å­—</p>
                            </div>

                            <div class="instruction-actions">
                                <button id="show-rules" class="btn btn-secondary">
                                    ğŸ“– æ˜¾ç¤ºæ‹†é™¤è§„åˆ™
                                </button>
                                <button id="clear-input" class="btn btn-secondary">
                                    âŒ æ¸…ç©ºè¾“å…¥
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Rules Modal -->
                    <div id="rules-modal" class="modal">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h3 class="modal-title">çº¿è·¯æ‹†é™¤è§„åˆ™</h3>
                                <button id="close-rules" class="modal-close">âœ•</button>
                            </div>

                            <div class="rules-content">
                                <div class="rule-section">
                                    <h4 class="rule-title">3æ ¹çº¿ï¼š</h4>
                                    <ul class="rule-list">
                                        <li class="rule-item">å¦‚æœæ²¡æœ‰çº¢çº¿ï¼Œåˆ™å‰ªæ–­ç¬¬äºŒæ ¹çº¿ã€‚</li>
                                        <li class="rule-item">å¦åˆ™ï¼Œå½“æœ€åä¸€æ ¹çº¿ä¸ºç™½çº¿æ—¶ï¼Œå‰ªæ–­æœ€åä¸€æ ¹çº¿ã€‚</li>
                                        <li class="rule-item">å¦åˆ™ï¼Œå½“æœ‰ä¸æ­¢ä¸€æ ¹è“çº¿çš„æ—¶å€™ï¼Œå‰ªæ–­æœ€åä¸€æ ¹è“çº¿ã€‚</li>
                                        <li class="rule-item">å¦åˆ™ï¼Œå‰ªæ–­æœ€åä¸€æ ¹çº¿ã€‚</li>
                                    </ul>
                                </div>

                                <div class="rule-section">
                                    <h4 class="rule-title">4æ ¹çº¿ï¼š</h4>
                                    <ul class="rule-list">
                                        <li class="rule-item">å¦‚æœæœ‰ä¸æ­¢ä¸€æ ¹çº¢çº¿ä¸”åºåˆ—å·æœ«ä½ä¸ºå¥‡æ•°ï¼Œåˆ™å‰ªæ–­æœ€åä¸€æ ¹çº¢çº¿ã€‚</li>
                                        <li class="rule-item">å¦åˆ™ï¼Œå½“æ²¡æœ‰çº¢çº¿ä¸”æœ€åä¸€æ ¹çº¿æ˜¯é»„çº¿æ—¶ï¼Œå‰ªæ–­ç¬¬ä¸€æ ¹çº¿ã€‚</li>
                                        <li class="rule-item">å¦åˆ™ï¼Œå½“æœ‰ä¸”ä»…æœ‰ä¸€æ ¹è“çº¿æ—¶ï¼Œå‰ªæ–­ç¬¬ä¸€æ ¹çº¿ã€‚</li>
                                        <li class="rule-item">å¦åˆ™ï¼Œå½“æœ‰ä¸æ­¢ä¸€æ ¹é»„çº¿æ—¶ï¼Œå‰ªæ–­æœ€åä¸€æ ¹çº¿ã€‚</li>
                                        <li class="rule-item">å¦åˆ™ï¼Œå‰ªæ–­ç¬¬äºŒæ ¹çº¿ã€‚</li>
                                    </ul>
                                </div>

                                <div class="rule-section">
                                    <h4 class="rule-title">5æ ¹çº¿ï¼š</h4>
                                    <ul class="rule-list">
                                        <li class="rule-item">å¦‚æœæœ€åä¸€æ ¹çº¿æ˜¯é»‘çº¿ä¸”åºåˆ—å·æœ«ä½ä¸ºå¥‡æ•°ï¼Œåˆ™å‰ªæ–­ç¬¬å››æ ¹çº¿ã€‚</li>
                                        <li class="rule-item">å¦åˆ™ï¼Œå½“æœ‰ä¸”ä»…æœ‰ä¸€æ ¹çº¢çº¿ï¼Œä¸”é»„çº¿ä¸æ­¢ä¸€æ ¹æ—¶ï¼Œå‰ªæ–­ç¬¬ä¸€æ ¹çº¿ã€‚</li>
                                        <li class="rule-item">å¦åˆ™ï¼Œå½“æ²¡æœ‰é»‘çº¿æ—¶ï¼Œå‰ªæ–­ç¬¬äºŒæ ¹çº¿ã€‚</li>
                                        <li class="rule-item">å¦åˆ™ï¼Œå‰ªæ–­ç¬¬ä¸€æ ¹çº¿ã€‚</li>
                                    </ul>
                                </div>

                                <div class="rule-section">
                                    <h4 class="rule-title">6æ ¹çº¿ï¼š</h4>
                                    <ul class="rule-list">
                                        <li class="rule-item">å¦‚æœæ²¡æœ‰é»„çº¿ä¸”åºåˆ—å·æœ«ä½ä¸ºå¥‡æ•°ï¼Œåˆ™å‰ªæ–­ç¬¬ä¸‰æ ¹çº¿ã€‚</li>
                                        <li class="rule-item">å¦åˆ™ï¼Œå½“æœ‰ä¸”ä»…æœ‰ä¸€æ ¹é»„çº¿ï¼Œä¸”ç™½çº¿ä¸æ­¢ä¸€æ ¹æ—¶ï¼Œå‰ªæ–­ç¬¬å››æ ¹çº¿ã€‚</li>
                                        <li class="rule-item">å¦åˆ™ï¼Œå½“æ²¡æœ‰çº¢çº¿æ—¶ï¼Œå‰ªæ–­æœ€åä¸€æ ¹çº¿ã€‚</li>
                                        <li class="rule-item">å¦åˆ™ï¼Œå‰ªæ–­ç¬¬å››æ ¹çº¿ã€‚</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Complex Wires Module -->
                <div id="module-complex-wires" class="module-content">
                    <div class="bomb-container">
                        <div class="module-header">
                            <h2 class="module-title">å¤æ‚çº¿è·¯æ¨¡å—</h2>
                            <div class="serial-input-group">
                                <span class="serial-label">åºåˆ—å·æœ«ä½:</span>
                                <input type="text" id="complex-serial-last" class="serial-input" maxlength="1"
                                    placeholder="?">
                                <span class="required-badge">*å¿…å¡«</span>
                            </div>
                        </div>

                        <!-- Input Section -->
                        <div class="input-section">
                            <h3 class="input-title">é€‰æ‹©LEDç¯çŠ¶æ€</h3>
                            <div class="button-group">
                                <button class="feature-btn" data-led="on">LEDç¯äº®èµ·</button>
                                <button class="feature-btn" data-led="off">LEDç¯ç†„ç­</button>
                            </div>
                        </div>

                        <div class="input-section">
                            <h3 class="input-title">é€‰æ‹©çº¿è·¯é¢œè‰²</h3>
                            <div class="button-group">
                                <button class="feature-btn" data-color="red">çº¢è‰²</button>
                                <button class="feature-btn" data-color="blue">è“è‰²</button>
                                <button class="feature-btn" data-color="red-blue">çº¢è“ï¼ˆä¸¤è‰²ï¼‰</button>
                                <button class="feature-btn" data-color="white">ç™½è‰²</button>
                            </div>
                        </div>

                        <div class="input-section">
                            <h3 class="input-title">é€‰æ‹©â˜…æ ‡è®°</h3>
                            <div class="button-group">
                                <button class="feature-btn" data-star="yes">æœ‰â˜…æ ‡è®°</button>
                                <button class="feature-btn" data-star="no">æ— â˜…æ ‡è®°</button>
                            </div>
                        </div>

                        <div class="input-section">
                            <h3 class="input-title">å…¶ä»–ä¿¡æ¯</h3>
                            <div class="button-group">
                                <button class="feature-btn" data-battery="0">æ— ç”µæ± </button>
                                <button class="feature-btn" data-battery="1">1ä¸ªç”µæ± </button>
                                <button class="feature-btn" data-battery="2">2ä¸ªæˆ–æ›´å¤šç”µæ± </button>
                            </div>
                            <div class="button-group mt-2">
                                <button class="feature-btn" data-parallel="yes">æœ‰Parallelç«¯å£</button>
                                <button class="feature-btn" data-parallel="no">æ— Parallelç«¯å£</button>
                            </div>
                        </div>

                        <!-- Instruction Section -->
                        <div class="instruction-section">
                            <h3 class="instruction-title">æ‹†é™¤æŒ‡ç¤º</h3>
                            <div id="complex-instruction" class="instruction-container">
                                <p style="color: var(--text-secondary); text-align: center; font-style: italic;">
                                    è¯·é€‰æ‹©LEDç¯çŠ¶æ€ã€çº¿è·¯é¢œè‰²å’Œâ˜…æ ‡è®°</p>
                            </div>

                            <div class="instruction-actions">
                                <button id="show-complex-rules" class="btn btn-secondary">
                                    ğŸ“– æ˜¾ç¤ºæ‹†é™¤è§„åˆ™
                                </button>
                                <button id="clear-complex" class="btn btn-secondary">
                                    âŒ æ¸…ç©ºé€‰æ‹©
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Complex Rules Modal -->
                    <div id="complex-rules-modal" class="modal">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h3 class="modal-title">å¤æ‚çº¿è·¯æ‹†é™¤è§„åˆ™</h3>
                                <button id="close-complex-rules" class="modal-close">âœ•</button>
                            </div>

                            <div class="rules-content">
                                <div class="rule-section">
                                    <h4 class="rule-title">åŸºæœ¬è§„åˆ™ï¼š</h4>
                                    <ul class="rule-list">
                                        <li class="rule-item">å¦‚æœLEDç¯äº®èµ·ä¸”çº¿è·¯ä¸ºè“è‰²ï¼Œå‰ªæ–­è¯¥çº¿</li>
                                        <li class="rule-item">å¦‚æœLEDç¯äº®èµ·ä¸”çº¿è·¯ä¸ºç™½è‰²ï¼Œæ ¹æ®åºåˆ—å·æœ«ä½åˆ¤æ–­</li>
                                        <li class="rule-item">å¦‚æœLEDç¯ç†„ç­ä¸”çº¿è·¯ä¸ºé»„è‰²ï¼Œå‰ªæ–­è¯¥çº¿</li>
                                        <li class="rule-item">å¦‚æœLEDç¯ç†„ç­ä¸”çº¿è·¯ä¸ºé»‘è‰²ä¸”æœ‰â˜…æ ‡è®°ï¼Œæ ¹æ®åºåˆ—å·æœ«ä½åˆ¤æ–­</li>
                                        <li class="rule-item">å…¶ä»–æƒ…å†µï¼Œä¸å‰ªæ–­è¯¥çº¿</li>
                                    </ul>
                                </div>

                                <div class="rule-section">
                                    <h4 class="rule-title">ç‰¹æ®Šè§„åˆ™ï¼š</h4>
                                    <ul class="rule-list">
                                        <li class="rule-item">åºåˆ—å·æœ«ä½ä¸ºå¶æ•°æ—¶çš„ç‰¹æ®Šåˆ¤æ–­</li>
                                        <li class="rule-item">ç”µæ± æ•°é‡æ£€æŸ¥</li>
                                        <li class="rule-item">Parallelç«¯å£æ£€æŸ¥</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Password Module -->
                <div id="module-password" class="module-content">
                    <div class="bomb-container">
                        <div class="module-header">
                            <h2 class="module-title">å¯†ç æ¨¡å—</h2>
                            <div class="module-description">
                                æ ¹æ®æ¯ä¸ªä½ç½®çš„å¯é€‰å­—æ¯ï¼Œæ‹¼å‡ºæ­£ç¡®çš„å•è¯
                            </div>
                        </div>

                        <div class="password-container">


                            <!-- å¯é€‰å­—æ¯è¾“å…¥æ¡† -->
                            <div class="available-letters">
                                <div class="input-group">
                                    <label for="letters-0" class="input-label">ç¬¬1ä½å¯é€‰å­—æ¯:</label>
                                    <div class="input-container">
                                        <input type="text" id="letters-0" class="wire-input"
                                            placeholder="è¾“å…¥å¯é€‰å­—æ¯ï¼ˆå¦‚ï¼šsjkï¼‰">
                                        <div class="input-icon">
                                            <i class="fas fa-keyboard"></i>
                                        </div>
                                    </div>
                                </div>
                                <div class="input-group">
                                    <label for="letters-1" class="input-label">ç¬¬2ä½å¯é€‰å­—æ¯:</label>
                                    <div class="input-container">
                                        <input type="text" id="letters-1" class="wire-input"
                                            placeholder="è¾“å…¥å¯é€‰å­—æ¯ï¼ˆå¦‚ï¼štpjqï¼‰">
                                        <div class="input-icon">
                                            <i class="fas fa-keyboard"></i>
                                        </div>
                                    </div>
                                </div>
                                <div class="input-group">
                                    <label for="letters-2" class="input-label">ç¬¬3ä½å¯é€‰å­—æ¯:</label>
                                    <div class="input-container">
                                        <input type="text" id="letters-2" class="wire-input" placeholder="è¾“å…¥å¯é€‰å­—æ¯">
                                        <div class="input-icon">
                                            <i class="fas fa-keyboard"></i>
                                        </div>
                                    </div>
                                </div>
                                <div class="input-group">
                                    <label for="letters-3" class="input-label">ç¬¬4ä½å¯é€‰å­—æ¯:</label>
                                    <div class="input-container">
                                        <input type="text" id="letters-3" class="wire-input" placeholder="è¾“å…¥å¯é€‰å­—æ¯">
                                        <div class="input-icon">
                                            <i class="fas fa-keyboard"></i>
                                        </div>
                                    </div>
                                </div>
                                <div class="input-group">
                                    <label for="letters-4" class="input-label">ç¬¬5ä½å¯é€‰å­—æ¯:</label>
                                    <div class="input-container">
                                        <input type="text" id="letters-4" class="wire-input" placeholder="è¾“å…¥å¯é€‰å­—æ¯">
                                        <div class="input-icon">
                                            <i class="fas fa-keyboard"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- æç¤ºä¿¡æ¯ -->
                            <div id="password-hint" class="hint-text">
                                è¯·è¾“å…¥æ¯ä¸ªä½ç½®çš„å¯é€‰å­—æ¯ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨æ˜¾ç¤ºå¯èƒ½çš„å•è¯
                            </div>

                            <!-- å¯èƒ½çš„å•è¯æ˜¾ç¤º -->
                            <div id="possible-words" class="possible-words">
                                <h4>å¯èƒ½çš„å•è¯ï¼š</h4>
                                <div class="words-list" id="words-list"></div>
                            </div>

                            <!-- æ“ä½œæŒ‰é’® -->
                            <div class="instruction-actions">
                                <button id="show-password-help" class="btn btn-secondary">
                                    ğŸ“– æ˜¾ç¤ºè§„åˆ™
                                </button>
                                <button id="reset-password" class="btn btn-secondary">
                                    âŒ é‡ç½®
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Password Rules Modal -->
                <div id="password-rules-modal" class="modal">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h3 class="modal-title">å¯†ç æ¨¡å—è§„åˆ™</h3>
                            <button id="close-password-rules" class="modal-close">âœ•</button>
                        </div>
                        <div class="rules-content">
                            <div class="rule-section">
                                <h4 class="rule-title">å¯†ç æ¨¡å—è§„åˆ™ï¼š</h4>
                                <ul class="rule-list">
                                    <li class="rule-item">æ ¹æ®æ¯ä¸ªä½ç½®æä¾›çš„å¯é€‰å­—æ¯ï¼Œæ‹¼å‡ºæ­£ç¡®çš„5å­—æ¯å•è¯</li>
                                    <li class="rule-item">æ­£ç¡®çš„å•è¯ä¸€å®šåœ¨ä»¥ä¸‹åˆ—è¡¨ä¸­ï¼š</li>
                                </ul>
                                <div class="word-list-container">
                                    <div class="word-columns">
                                        <div class="word-column">
                                            <span>about</span><span>after</span><span>again</span><span>below</span><span>could</span>
                                            <span>every</span><span>first</span><span>found</span><span>great</span><span>house</span>
                                        </div>
                                        <div class="word-column">
                                            <span>large</span><span>learn</span><span>never</span><span>other</span><span>place</span>
                                            <span>plant</span><span>point</span><span>right</span><span>small</span><span>sound</span>
                                        </div>
                                        <div class="word-column">
                                            <span>spell</span><span>still</span><span>study</span><span>their</span><span>there</span>
                                            <span>these</span><span>thing</span><span>think</span><span>three</span><span>water</span>
                                        </div>
                                        <div class="word-column">
                                            <span>where</span><span>which</span><span>world</span><span>would</span><span>write</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="rule-section">
                                <h4 class="rule-title">æ“ä½œæ–¹æ³•ï¼š</h4>
                                <ol class="rule-list">
                                    <li class="rule-item">åœ¨æ¯ä¸ªä½ç½®çš„è¾“å…¥æ¡†ä¸­è¾“å…¥å¯é€‰å­—æ¯ï¼ˆä¸åŒºåˆ†å¤§å°å†™ï¼‰</li>
                                    <li class="rule-item">ä½¿ç”¨ä¸Šä¸‹æŒ‰é’®åˆ‡æ¢å½“å‰é€‰ä¸­çš„å­—æ¯</li>
                                    <li class="rule-item">ç³»ç»Ÿä¼šå®æ—¶æ˜¾ç¤ºå¯èƒ½çš„å•è¯</li>
                                    <li class="rule-item">å½“æ‹¼å‡ºæ­£ç¡®çš„å•è¯æ—¶ï¼Œç‚¹å‡»"æäº¤å¯†ç "æŒ‰é’®</li>
                                </ol>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Memory Module -->
                <div id="module-sequence" class="module-content">
                    <div class="bomb-container">
                        <div class="module-header">
                            <h2 class="module-title">é¡ºåºçº¿è·¯</h2>
                        </div>
                
                        <div class="sequence-buttons">
                            <button class="sequence-btn red" onclick="addSequence('red')">
                                <i class="fas fa-circle"></i> çº¢è‰²
                            </button>
                            <button class="sequence-btn blue" onclick="addSequence('blue')">
                                <i class="fas fa-circle"></i> è“è‰²
                            </button>
                            <button class="sequence-btn black" onclick="addSequence('black')">
                                <i class="fas fa-circle"></i> é»‘è‰²
                            </button>
                        </div>
                
                        <div class="sequence-instructions">
                            <h3>æ“ä½œæŒ‡å¼•</h3>
                            <p id="sequence-instruction" class="instruction-text">
                                è¯·ç‚¹å‡»ä¸Šæ–¹é¢œè‰²æŒ‰é’®æ¥è®°å½•å‡ºç°çš„çº¿æ¡é¡ºåºï¼Œç³»ç»Ÿå°†è‡ªåŠ¨é«˜äº®å¯¹åº”çš„å‰ªæ–­æŒ‡å¼•ã€‚
                            </p>
                        </div>
                
                        <div class="instruction-actions">
                            <button id="show-sequence-rules" class="btn btn-secondary">
                                ğŸ“– æ˜¾ç¤ºæ‹†é™¤è§„åˆ™
                            </button>
                            <button id="reset-sequence-module" class="btn btn-secondary">
                                âŒ é‡ç½®æ¨¡å—
                            </button>
                        </div>
                
                        <div class="sequence-display">
                            <h3>å½“å‰åºåˆ—</h3>
                            <div id="sequence-list" class="sequence-list"></div>
                        </div>
                
                        <div class="sequence-table-container">
                            <table class="sequence-table">
                                <thead>
                                    <tr>
                                        <th>çº¢çº¿å‡ºç°æ¬¡æ•°</th>
                                        <th>å‰ªæ–­</th>
                                        <th>è“çº¿å‡ºç°æ¬¡æ•°</th>
                                        <th>å‰ªæ–­</th>
                                        <th>é»‘çº¿å‡ºç°æ¬¡æ•°</th>
                                        <th>å‰ªæ–­</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr class="red-row" data-index="1">
                                        <td>ç¬¬ä¸€æ ¹çº¢çº¿</td>
                                        <td>C</td>
                                        <td>ç¬¬ä¸€æ ¹è“çº¿</td>
                                        <td>B</td>
                                        <td>ç¬¬ä¸€æ ¹é»‘çº¿</td>
                                        <td>Aã€Bæˆ–C</td>
                                    </tr>
                                    <tr class="red-row" data-index="2">
                                        <td>ç¬¬äºŒæ ¹çº¢çº¿</td>
                                        <td>B</td>
                                        <td>ç¬¬äºŒæ ¹è“çº¿</td>
                                        <td>Aæˆ–C</td>
                                        <td>ç¬¬äºŒæ ¹é»‘çº¿</td>
                                        <td>Aæˆ–C</td>
                                    </tr>
                                    <tr class="red-row" data-index="3">
                                        <td>ç¬¬ä¸‰æ ¹çº¢çº¿</td>
                                        <td>A</td>
                                        <td>ç¬¬ä¸‰æ ¹è“çº¿</td>
                                        <td>B</td>
                                        <td>ç¬¬ä¸‰æ ¹é»‘çº¿</td>
                                        <td>B</td>
                                    </tr>
                                    <tr class="red-row" data-index="4">
                                        <td>ç¬¬å››æ ¹çº¢çº¿</td>
                                        <td>Aæˆ–C</td>
                                        <td>ç¬¬å››æ ¹è“çº¿</td>
                                        <td>A</td>
                                        <td>ç¬¬å››æ ¹é»‘çº¿</td>
                                        <td>Aæˆ–C</td>
                                    </tr>
                                    <tr class="red-row" data-index="5">
                                        <td>ç¬¬äº”æ ¹çº¢çº¿</td>
                                        <td>B</td>
                                        <td>ç¬¬äº”æ ¹è“çº¿</td>
                                        <td>B</td>
                                        <td>ç¬¬äº”æ ¹é»‘çº¿</td>
                                        <td>B</td>
                                    </tr>
                                    <tr class="red-row" data-index="6">
                                        <td>ç¬¬å…­æ ¹çº¢çº¿</td>
                                        <td>Aæˆ–C</td>
                                        <td>ç¬¬å…­æ ¹è“çº¿</td>
                                        <td>Bæˆ–C</td>
                                        <td>ç¬¬å…­æ ¹é»‘çº¿</td>
                                        <td>Bæˆ–C</td>
                                    </tr>
                                    <tr class="red-row" data-index="7">
                                        <td>ç¬¬ä¸ƒæ ¹çº¢çº¿</td>
                                        <td>Aã€Bæˆ–C</td>
                                        <td>ç¬¬ä¸ƒæ ¹è“çº¿</td>
                                        <td>C</td>
                                        <td>ç¬¬ä¸ƒæ ¹é»‘çº¿</td>
                                        <td>Aæˆ–B</td>
                                    </tr>
                                    <tr class="red-row" data-index="8">
                                        <td>ç¬¬å…«æ ¹çº¢çº¿</td>
                                        <td>Aæˆ–B</td>
                                        <td>ç¬¬å…«æ ¹è“çº¿</td>
                                        <td>Aæˆ–C</td>
                                        <td>ç¬¬å…«æ ¹é»‘çº¿</td>
                                        <td>C</td>
                                    </tr>
                                    <tr class="red-row" data-index="9">
                                        <td>ç¬¬ä¹æ ¹çº¢çº¿</td>
                                        <td>B</td>
                                        <td>ç¬¬ä¹æ ¹è“çº¿</td>
                                        <td>A</td>
                                        <td>ç¬¬ä¹æ ¹é»‘çº¿</td>
                                        <td>C</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                
                
                    </div>
                </div>
                
                <div id="module-memory" class="module-content">
                    <div class="bomb-container">
                        <div class="module-header">
                            <h2 class="module-title">è®°å¿†æ¨¡å—</h2>
                            <div class="stage-indicator">
                                <span class="serial-label">å½“å‰é˜¶æ®µ:</span>
                                <span id="current-stage" class="serial-input" style="width: 2rem;">1</span>
                            </div>
                        </div>
                
                        <!-- Display Section -->
                        <div class="input-section">
                            <h3 class="input-title">æ˜¾ç¤ºæ•°å­—</h3>
                            <div class="button-group">
                                <button class="feature-btn" data-display="1">æ˜¾ç¤º 1</button>
                                <button class="feature-btn" data-display="2">æ˜¾ç¤º 2</button>
                                <button class="feature-btn" data-display="3">æ˜¾ç¤º 3</button>
                                <button class="feature-btn" data-display="4">æ˜¾ç¤º 4</button>
                            </div>
                        </div>
                
                        <!-- Instruction Section -->
                        <div class="instruction-section">
                            <h3 class="instruction-title">æ“ä½œæŒ‡ç¤º</h3>
                            <div id="memory-instruction" class="instruction-container">
                                <p style="color: var(--text-secondary); text-align: center; font-style: italic;">
                                    è¯·é€‰æ‹©å½“å‰é˜¶æ®µæ˜¾ç¤ºçš„æ•°å­—ï¼Œç„¶åæ ¹æ®è§„åˆ™æŒ‰ä¸‹æ­£ç¡®çš„æŒ‰é’®</p>
                            </div>
                        </div>
                
                        <!-- Button Panel -->
                        <div class="input-section">
                            <h3 class="input-title">æŒ‰é’®é¢æ¿</h3>
                            <div class="button-panel">
                                <div class="button-row">
                                    <span class="row-label">ä½ç½®æŒ‰é’®:</span>
                                    <button class="memory-btn position-btn" data-position="1">1</button>
                                    <button class="memory-btn position-btn" data-position="2">2</button>
                                    <button class="memory-btn position-btn" data-position="3">3</button>
                                    <button class="memory-btn position-btn" data-position="4">4</button>
                                </div>
                                <div class="button-row">
                                    <span class="row-label">æ•°å­—æŒ‰é’®:</span>
                                    <button class="memory-btn number-btn" data-number="1">1</button>
                                    <button class="memory-btn number-btn" data-number="2">2</button>
                                    <button class="memory-btn number-btn" data-number="3">3</button>
                                    <button class="memory-btn number-btn" data-number="4">4</button>
                                </div>
                            </div>
                        </div>
                
                        <!-- Stage Tracking -->
                        <div class="input-section">
                            <h3 class="input-title">é˜¶æ®µè®°å½•</h3>
                            <div class="stage-tracker">
                                <div class="stage-header">
                                    <span class="stage-label">é˜¶æ®µ</span>
                                    <span class="stage-header-item">æ˜¾ç¤ºæ•°å­—</span>
                                    <span class="stage-header-item">æŒ‰ä¸‹æ•°å­—</span>
                                    <span class="stage-header-item">å¯¹åº”ä½ç½®</span>
                                </div>
                                <div class="stage-row">
                                    <span class="stage-label">1</span>
                                    <input type="text" class="stage-input" id="stage-1-display" placeholder="?" maxlength="1"
                                        readonly="">
                                    <input type="text" class="stage-input" id="stage-1-button" placeholder="?" maxlength="1"
                                        readonly="">
                                    <input type="text" class="stage-input" id="stage-1-position" placeholder="?" maxlength="1"
                                        readonly="">
                                </div>
                                <div class="stage-row">
                                    <span class="stage-label">2</span>
                                    <input type="text" class="stage-input" id="stage-2-display" placeholder="?" maxlength="1"
                                        readonly="">
                                    <input type="text" class="stage-input" id="stage-2-button" placeholder="?" maxlength="1"
                                        readonly="">
                                    <input type="text" class="stage-input" id="stage-2-position" placeholder="?" maxlength="1"
                                        readonly="">
                                </div>
                                <div class="stage-row">
                                    <span class="stage-label">3</span>
                                    <input type="text" class="stage-input" id="stage-3-display" placeholder="?" maxlength="1"
                                        readonly="">
                                    <input type="text" class="stage-input" id="stage-3-button" placeholder="?" maxlength="1"
                                        readonly="">
                                    <input type="text" class="stage-input" id="stage-3-position" placeholder="?" maxlength="1"
                                        readonly="">
                                </div>
                                <div class="stage-row">
                                    <span class="stage-label">4</span>
                                    <input type="text" class="stage-input" id="stage-4-display" placeholder="?" maxlength="1"
                                        readonly="">
                                    <input type="text" class="stage-input" id="stage-4-button" placeholder="?" maxlength="1"
                                        readonly="">
                                    <input type="text" class="stage-input" id="stage-4-position" placeholder="?" maxlength="1"
                                        readonly="">
                                </div>
                                <div class="stage-row">
                                    <span class="stage-label">5</span>
                                    <input type="text" class="stage-input" id="stage-5-display" placeholder="?" maxlength="1"
                                        readonly="">
                                    <input type="text" class="stage-input" id="stage-5-button" placeholder="?" maxlength="1"
                                        readonly="">
                                    <input type="text" class="stage-input" id="stage-5-position" placeholder="?" maxlength="1"
                                        readonly="">
                                </div>
                            </div>
                        </div>
                
                        <!-- Actions -->
                        <div class="instruction-actions">
                            <button id="show-memory-rules" class="btn btn-secondary">
                                ğŸ“– æ˜¾ç¤ºè®°å¿†è§„åˆ™
                            </button>
                            <button id="reset-memory" class="btn btn-secondary">
                                ğŸ”„ é‡ç½®æ¨¡å—
                            </button>
                        </div>
                    </div>
                
                    <!-- Memory Rules Modal -->
                    <div id="memory-rules-modal" class="modal">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h3 class="modal-title">è®°å¿†æ¨¡å—è§„åˆ™</h3>
                                <button id="close-memory-rules" class="modal-close">âœ•</button>
                            </div>
                
                            <div class="rules-content">
                                <div class="rule-section">
                                    <h4 class="rule-title">é˜¶æ®µ 1ï¼š</h4>
                                    <ul class="rule-list">
                                        <li class="rule-item">å¦‚æœæ˜¾ç¤ºçš„æ˜¯ 1ï¼ŒæŒ‰ä¸‹ç¬¬äºŒä¸ªä½ç½®çš„æŒ‰é’®ã€‚</li>
                                        <li class="rule-item">å¦‚æœæ˜¾ç¤ºçš„æ˜¯ 2ï¼ŒæŒ‰ä¸‹ç¬¬äºŒä¸ªä½ç½®çš„æŒ‰é’®ã€‚</li>
                                        <li class="rule-item">å¦‚æœæ˜¾ç¤ºçš„æ˜¯ 3ï¼ŒæŒ‰ä¸‹ç¬¬ä¸‰ä¸ªä½ç½®çš„æŒ‰é’®ã€‚</li>
                                        <li class="rule-item">å¦‚æœæ˜¾ç¤ºçš„æ˜¯ 4ï¼ŒæŒ‰ä¸‹ç¬¬å››ä¸ªä½ç½®çš„æŒ‰é’®ã€‚</li>
                                    </ul>
                                </div>
                
                                <div class="rule-section">
                                    <h4 class="rule-title">é˜¶æ®µ 2ï¼š</h4>
                                    <ul class="rule-list">
                                        <li class="rule-item">å¦‚æœæ˜¾ç¤ºçš„æ˜¯ 1ï¼ŒæŒ‰ä¸‹æ•°å­—ä¸º"4"çš„æŒ‰é’®ã€‚</li>
                                        <li class="rule-item">å¦‚æœæ˜¾ç¤ºçš„æ˜¯ 2ï¼ŒæŒ‰ä¸‹å’Œé˜¶æ®µ 1 ä¸­ä½ æ‰€æŒ‰ä¸‹çš„æŒ‰é’®ä½ç½®ç›¸åŒçš„æŒ‰é’®ã€‚</li>
                                        <li class="rule-item">å¦‚æœæ˜¾ç¤ºçš„æ˜¯ 3ï¼ŒæŒ‰ä¸‹ç¬¬ä¸€ä¸ªä½ç½®çš„æŒ‰é’®ã€‚</li>
                                        <li class="rule-item">å¦‚æœæ˜¾ç¤ºçš„æ˜¯ 4ï¼ŒæŒ‰ä¸‹å’Œé˜¶æ®µ 1 ä¸­ä½ æ‰€æŒ‰ä¸‹çš„æŒ‰é’®ä½ç½®ç›¸åŒçš„æŒ‰é’®ã€‚</li>
                                    </ul>
                                </div>
                
                                <div class="rule-section">
                                    <h4 class="rule-title">é˜¶æ®µ 3ï¼š</h4>
                                    <ul class="rule-list">
                                        <li class="rule-item">å¦‚æœæ˜¾ç¤ºçš„æ˜¯ 1ï¼ŒæŒ‰ä¸‹å’Œé˜¶æ®µ 2 ä¸­ä½ æ‰€æŒ‰ä¸‹çš„æŒ‰é’®æ•°å­—ç›¸åŒçš„æŒ‰é’®ã€‚</li>
                                        <li class="rule-item">å¦‚æœæ˜¾ç¤ºçš„æ˜¯ 2ï¼ŒæŒ‰ä¸‹å’Œé˜¶æ®µ 1 ä¸­ä½ æ‰€æŒ‰ä¸‹çš„æŒ‰é’®æ•°å­—ç›¸åŒçš„æŒ‰é’®ã€‚</li>
                                        <li class="rule-item">å¦‚æœæ˜¾ç¤ºçš„æ˜¯ 3ï¼ŒæŒ‰ä¸‹ç¬¬ä¸‰ä¸ªä½ç½®çš„æŒ‰é’®ã€‚</li>
                                        <li class="rule-item">å¦‚æœæ˜¾ç¤ºçš„æ˜¯ 4ï¼ŒæŒ‰ä¸‹æ•°å­—ä¸º"4"çš„æŒ‰é’®ã€‚</li>
                                    </ul>
                                </div>
                
                                <div class="rule-section">
                                    <h4 class="rule-title">é˜¶æ®µ 4ï¼š</h4>
                                    <ul class="rule-list">
                                        <li class="rule-item">å¦‚æœæ˜¾ç¤ºçš„æ˜¯ 1ï¼ŒæŒ‰ä¸‹å’Œé˜¶æ®µ 1 ä¸­ä½ æ‰€æŒ‰ä¸‹çš„æŒ‰é’®ä½ç½®ç›¸åŒçš„æŒ‰é’®ã€‚</li>
                                        <li class="rule-item">å¦‚æœæ˜¾ç¤ºçš„æ˜¯ 2ï¼ŒæŒ‰ä¸‹ç¬¬ä¸€ä¸ªä½ç½®çš„æŒ‰é’®ã€‚</li>
                                        <li class="rule-item">å¦‚æœæ˜¾ç¤ºçš„æ˜¯ 3ï¼ŒæŒ‰ä¸‹å’Œé˜¶æ®µ 2 ä¸­ä½ æ‰€æŒ‰ä¸‹çš„æŒ‰é’®ä½ç½®ç›¸åŒçš„æŒ‰é’®ã€‚</li>
                                        <li class="rule-item">å¦‚æœæ˜¾ç¤ºçš„æ˜¯ 4ï¼ŒæŒ‰ä¸‹å’Œé˜¶æ®µ 2 ä¸­ä½ æ‰€æŒ‰ä¸‹çš„æŒ‰é’®ä½ç½®ç›¸åŒçš„æŒ‰é’®ã€‚</li>
                                    </ul>
                                </div>
                
                                <div class="rule-section">
                                    <h4 class="rule-title">é˜¶æ®µ 5ï¼š</h4>
                                    <ul class="rule-list">
                                        <li class="rule-item">å¦‚æœæ˜¾ç¤ºçš„æ˜¯ 1ï¼ŒæŒ‰ä¸‹å’Œé˜¶æ®µ 1 ä¸­ä½ æ‰€æŒ‰ä¸‹çš„æŒ‰é’®æ•°å­—ç›¸åŒçš„æŒ‰é’®ã€‚</li>
                                        <li class="rule-item">å¦‚æœæ˜¾ç¤ºçš„æ˜¯ 2ï¼ŒæŒ‰ä¸‹å’Œé˜¶æ®µ 2 ä¸­ä½ æ‰€æŒ‰ä¸‹çš„æŒ‰é’®æ•°å­—ç›¸åŒçš„æŒ‰é’®ã€‚</li>
                                        <li class="rule-item">å¦‚æœæ˜¾ç¤ºçš„æ˜¯ 3ï¼ŒæŒ‰ä¸‹å’Œé˜¶æ®µ 4 ä¸­ä½ æ‰€æŒ‰ä¸‹çš„æŒ‰é’®æ•°å­—ç›¸åŒçš„æŒ‰é’®ã€‚</li>
                                        <li class="rule-item">å¦‚æœæ˜¾ç¤ºçš„æ˜¯ 4ï¼ŒæŒ‰ä¸‹å’Œé˜¶æ®µ 3 ä¸­ä½ æ‰€æŒ‰ä¸‹çš„æŒ‰é’®æ•°å­—ç›¸åŒçš„æŒ‰é’®ã€‚</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <p>æ‹†å¼¹ä¸“å®¶è§£å¯†åŠ©æ‰‹ Â© 2025 | ä¿æŒå†·é™ï¼Œä½ èƒ½æˆåŠŸæ‹†é™¤ç‚¸å¼¹ï¼</p>
    </footer>


    <script>
        // å…¨å±€å˜é‡
        const modules = {
            wires: null,
            complexWires: null
        };

        // é¢œè‰²æ˜ å°„è¡¨
        const colorMap = {
            '1': 'çº¢',
            '2': 'é»„',
            '3': 'è“',
            '4': 'é»‘',
            '5': 'ç™½'
        };

        // é¢œè‰²CSSç±»æ˜ å°„
        const colorClassMap = {
            '1': 'wire-red',
            '2': 'wire-yellow',
            '3': 'wire-blue',
            '4': 'wire-black',
            '5': 'wire-white'
        };

        // ä½ç½®æè¿°æ˜ å°„
        const positionDescMap = {
            1: 'ç¬¬ä¸€æ ¹',
            2: 'ç¬¬äºŒæ ¹',
            3: 'ç¬¬ä¸‰æ ¹',
            4: 'ç¬¬å››æ ¹',
            5: 'ç¬¬äº”æ ¹',
            6: 'ç¬¬å…­æ ¹'
        };

        // æ¨¡å—åˆ‡æ¢åŠŸèƒ½
        function setupModuleSwitching() {
            const tabs = document.querySelectorAll('[id^="tab-"]');

            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    if (tab.classList.contains('disabled')) {
                        alert('è¯¥æ¨¡å—å°šæœªå®ç°');
                        return;
                    }

                    const targetModule = tab.getAttribute('data-module');

                    // æ›´æ–°æ ‡ç­¾çŠ¶æ€
                    tabs.forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');

                    // æ›´æ–°å†…å®¹æ˜¾ç¤º
                    const contents = document.querySelectorAll('.module-content');
                    contents.forEach(content => {
                        content.classList.remove('active');
                    });

                    if (targetModule) {
                        document.getElementById(targetModule).classList.add('active');
                    }
                });
            });
        }

        // é¡ºåºçº¿è·¯è¾…åŠ©å‡½æ•°
        function addSequence(color) {
            if (modules.sequence) {
                const currentSequence = modules.sequence.sequence || [];
                if (currentSequence.length >= 12) {
                    alert('åºåˆ—å·²è¾¾åˆ°æœ€å¤§æ­¥æ•°é™åˆ¶ï¼ˆ12æ­¥ï¼‰');
                    return;
                }
                modules.sequence.addColor(color);
            }
        }

        function showSequenceHelp() {
            const helpContent = `
                <div class="help-content">
                    <h3>é¡ºåºçº¿è·¯è§„åˆ™</h3>
                    <p>é¡ºåºçº¿è·¯ä¼šæŒ‰ç…§ç‰¹å®šé¡ºåºæ˜¾ç¤ºçº¢ã€è“ã€é»‘ä¸‰ç§é¢œè‰²çš„çº¿æ¡ã€‚</p>
                    <p>æ ¹æ®æ¯ç§é¢œè‰²å‡ºç°çš„æ¬¡æ•°ï¼ŒæŒ‰ç…§ä¸‹è¡¨ç¡®å®šåº”è¯¥å‰ªæ–­çš„çº¿è·¯ï¼š</p>
                    <ul>
                        <li><strong>A</strong> - ç¬¬ä¸€æ ¹çº¿è·¯</li>
                        <li><strong>B</strong> - ç¬¬äºŒæ ¹çº¿è·¯</li>
                        <li><strong>C</strong> - ç¬¬ä¸‰æ ¹çº¿è·¯</li>
                    </ul>
                    <p>æ“ä½œæ–¹æ³•ï¼š</p>
                    <ol>
                        <li>ç‚¹å‡»ä¸Šæ–¹é¢œè‰²æŒ‰é’®è®°å½•å‡ºç°çš„çº¿æ¡é¡ºåº</li>
                        <li>ç³»ç»Ÿä¼šè‡ªåŠ¨é«˜äº®å¯¹åº”çš„å‰ªæ–­æŒ‡å¼•</li>
                        <li>æŒ‰ç…§æŒ‡å¼•å‰ªæ–­æ­£ç¡®çš„çº¿è·¯</li>
                    </ol>
                </div>
            `;
            showModal('é¡ºåºçº¿è·¯å¸®åŠ©', helpContent);

            // æ˜¾ç¤ºåºåˆ—è¡¨æ ¼
            const tableContainer = document.querySelector('.sequence-table-container');
            if (tableContainer) {
                tableContainer.style.display = 'block';
            }
        }

        function resetSequenceModule() {
            console.log('é‡ç½®é¡ºåºçº¿è·¯');
            if (modules && modules.sequence) {
                // é‡ç½®æ¨¡å—æ•°æ®
                modules.sequence.reset();

                // æ¸…ç©ºåºåˆ—æ˜¾ç¤º
                const sequenceList = document.getElementById('sequence-list');
                if (sequenceList) {
                    sequenceList.innerHTML = '';
                }

                // é‡ç½®æ“ä½œæŒ‡å¼•
                const instruction = document.getElementById('sequence-instruction');
                if (instruction) {
                    instruction.textContent = 'è¯·ç‚¹å‡»ä¸Šæ–¹é¢œè‰²æŒ‰é’®æ¥è®°å½•å‡ºç°çš„çº¿æ¡é¡ºåºï¼Œç³»ç»Ÿå°†è‡ªåŠ¨é«˜äº®å¯¹åº”çš„å‰ªæ–­æŒ‡å¼•ã€‚';
                }

                // ç§»é™¤è¡¨æ ¼é«˜äº®
                document.querySelectorAll('.sequence-table tr').forEach(row => {
                    row.classList.remove('highlight', 'highlight-red', 'highlight-blue', 'highlight-black');
                });
            } else {
                console.error('é¡ºåºçº¿è·¯æœªåˆå§‹åŒ–');
                alert('é¡ºåºçº¿è·¯æœªæ­£ç¡®åˆå§‹åŒ–ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•');
            }
        }

        // åŸºç¡€çº¿è·¯æ¨¡å—
        class WiresModule {
            constructor() {
                this.currentWires = ['1', '3', '2']; // é»˜è®¤3æ ¹çº¿ï¼šçº¢è“é»„
                this.currentWireCount = 3;
                this.correctWireIndex = -1;
                this.wireElements = [
                    document.getElementById('wire-1'),
                    document.getElementById('wire-2'),
                    document.getElementById('wire-3'),
                    document.getElementById('wire-4'),
                    document.getElementById('wire-5'),
                    document.getElementById('wire-6')
                ];

                this.initialize();
            }

            initialize() {
                this.initializeWires();
                this.setupEventListeners();
                this.updateCutInstruction();
            }

            initializeWires() {
                // æ˜¾ç¤º/éšè—çº¿è·¯
                this.wireElements.forEach((el, index) => {
                    if (index < this.currentWireCount) {
                        el.classList.remove('hidden');
                        this.updateWireColor(el, this.currentWires[index]);
                    } else {
                        el.classList.add('hidden');
                    }
                    el.classList.remove('cut', 'correct', 'incorrect');
                });

                // è®¡ç®—æ­£ç¡®çš„çº¿è·¯
                const serialLast = document.getElementById('serial-last').value;
                if (serialLast) {
                    const result = this.getCutWire(this.currentWires.join(''), parseInt(serialLast));
                    this.correctWireIndex = result[0] - 1; // è½¬æ¢ä¸º0åŸºç´¢å¼•
                } else {
                    this.correctWireIndex = -1;
                }
            }

            updateWireColor(wireElement, colorCode) {
                // ç§»é™¤æ‰€æœ‰é¢œè‰²ç±»
                Object.values(colorClassMap).forEach(className => {
                    wireElement.classList.remove(className);
                });
                // æ·»åŠ æ–°é¢œè‰²ç±»
                wireElement.classList.add(colorClassMap[colorCode]);
            }

            setupEventListeners() {
                // åºåˆ—å·è¾“å…¥
                document.getElementById('serial-last').addEventListener('input', (e) => {
                    // åªå…è®¸è¾“å…¥æ•°å­—
                    e.target.value = e.target.value.replace(/[^0-9]/g, '');
                    if (e.target.value) {
                        this.updateCutInstruction();
                    }
                });

                // çº¿è·¯è¾“å…¥
                document.getElementById('wire-input').addEventListener('input', (e) => {
                    // åªå…è®¸è¾“å…¥1-5çš„æ•°å­—
                    e.target.value = e.target.value.replace(/[^1-5]/g, '');
                    this.updateWiresFromInput();
                    this.updateCutInstruction();
                });

                // çº¿è·¯ç‚¹å‡»äº‹ä»¶
                this.wireElements.forEach((el, index) => {
                    el.addEventListener('click', () => this.cutWire(index));
                });

                // æ¸…ç©ºè¾“å…¥æŒ‰é’®
                document.getElementById('clear-input').addEventListener('click', () => {
                    this.reset();
                });

                // æ˜¾ç¤ºè§„åˆ™æŒ‰é’®
                document.getElementById('show-rules').addEventListener('click', () => {
                    document.getElementById('rules-modal').style.display = 'flex';
                });

                // å…³é—­è§„åˆ™æŒ‰é’®
                document.getElementById('close-rules').addEventListener('click', () => {
                    document.getElementById('rules-modal').style.display = 'none';
                });

                // ç‚¹å‡»æ¨¡æ€æ¡†èƒŒæ™¯å…³é—­
                document.getElementById('rules-modal').addEventListener('click', (e) => {
                    if (e.target === document.getElementById('rules-modal')) {
                        document.getElementById('rules-modal').style.display = 'none';
                    }
                });
            }

            updateWiresFromInput() {
                const wireInput = document.getElementById('wire-input').value;
                if (wireInput.length >= 3 && wireInput.length <= 6) {
                    this.currentWires = wireInput.split('');
                    this.currentWireCount = wireInput.length;
                    this.initializeWires();
                }
            }

            cutWire(index) {
                const wireElement = this.wireElements[index];

                // å¦‚æœçº¿è·¯å·²ç»è¢«å‰ªæ–­ï¼Œä¸åšä»»ä½•æ“ä½œ
                if (wireElement.classList.contains('cut')) {
                    return;
                }

                // æ£€æŸ¥åºåˆ—å·æ˜¯å¦å·²è¾“å…¥
                const serialLast = document.getElementById('serial-last').value;
                const wireInput = document.getElementById('wire-input').value;

                if (!serialLast || !wireInput || wireInput.length < 3 || wireInput.length > 6) {
                    alert('è¯·å…ˆè¾“å…¥æœ‰æ•ˆçš„çº¿è·¯ä»£ç å’Œåºåˆ—å·æœ«ä½æ•°å­—');
                    return;
                }

                // è®¡ç®—æ­£ç¡®çš„çº¿è·¯
                const result = this.getCutWire(this.currentWires.join(''), parseInt(serialLast));
                this.correctWireIndex = result[0] - 1; // è½¬æ¢ä¸º0åŸºç´¢å¼•

                // æ ‡è®°çº¿è·¯ä¸ºå·²å‰ªæ–­
                wireElement.classList.add('cut');

                // æ£€æŸ¥æ˜¯å¦å‰ªå¯¹äº†
                if (index === this.correctWireIndex) {
                    wireElement.classList.add('correct');
                    alert('æ­£ç¡®ï¼çº¿è·¯å·²æˆåŠŸæ‹†é™¤');

                    // é‡ç½®çº¿è·¯
                    setTimeout(() => {
                        this.reset();
                    }, 1500);
                } else {
                    wireElement.classList.add('incorrect');
                    alert('é”™è¯¯ï¼è¯·é‡æ–°å°è¯•');
                }
            }

            updateCutInstruction() {
                const instructionElement = document.getElementById('cut-instruction');
                const serialLast = document.getElementById('serial-last').value;
                const wireInput = document.getElementById('wire-input').value;

                if (!serialLast || !wireInput || wireInput.length < 3 || wireInput.length > 6) {
                    instructionElement.innerHTML = `
                        <div class="text-center">
                            <p class="text-gray-400 italic">è¯·è¾“å…¥æœ‰æ•ˆçš„çº¿è·¯ä»£ç ï¼ˆ3-6ä½æ•°å­—ï¼‰å’Œåºåˆ—å·æœ«ä½æ•°å­—</p>
                            ${!serialLast ? '<p class="text-warning text-sm mt-2"><i class="fa fa-exclamation-circle"></i> è¯·è¾“å…¥åºåˆ—å·æœ«ä½æ•°å­—</p>' : ''}
                            ${wireInput && (wireInput.length < 3 || wireInput.length > 6) ? '<p class="text-warning text-sm mt-2"><i class="fa fa-exclamation-circle"></i> çº¿è·¯ä»£ç å¿…é¡»æ˜¯3-6ä½æ•°å­—</p>' : ''}
                        </div>
                    `;
                    return;
                }

                const wireCode = this.currentWires.join('');
                const result = this.getCutWire(wireCode, parseInt(serialLast));

                if (result[0] === 0) {
                    instructionElement.innerHTML = `
                        <p class="text-danger text-center">é”™è¯¯: ${result[1]}</p>
                    `;
                } else {
                    // è§£æå¹¶æ˜¾ç¤ºçº¿è·¯è¯¦æƒ…
                    const wireDetails = this.currentWires.map((c, i) =>
                        `<span class="inline-block px-2 py-1 rounded ${colorClassMap[c]} mr-1">${i + 1}(${colorMap[c]})</span>`
                    );

                    instructionElement.innerHTML = `
                        <div>
                            <div>
                                <p style="font-size: 0.875rem; color: var(--text-secondary); margin-bottom: 0.5rem;">çº¿è·¯åˆ—è¡¨(ä»ä¸Šåˆ°ä¸‹):</p>
                                <div style="display: flex; flex-wrap: wrap; gap: 0.25rem;">
                                    ${wireDetails.join('')}
                                </div>
                            </div>

                            <div style="background-color: #0f172a; padding: 1rem; border-radius: 8px; margin: 1rem 0;">
                                <p style="font-size: 1.125rem; font-weight: 600; color: var(--warning-color);">éœ€è¦å‰ªæ–­: <span style="color: var(--text-color);">${result[2]}(${result[1]}è‰²çº¿)</span></p>
                                <p style="font-size: 0.875rem; color: var(--text-secondary);">ä½ç½®åºå·: ${result[0]}</p>
                            </div>
                        </div>
                    `;
                }
            }

            reset() {
                document.getElementById('wire-input').value = '';
                // ä¿ç•™åºåˆ—å·æœ«ä½
                this.currentWires = ['1', '3', '2'];
                this.currentWireCount = 3;
                this.initializeWires();
                this.updateCutInstruction();
            }

            getCutWire(wireCode, serialLastDigit) {
                // è§£æçº¿è·¯ä¿¡æ¯
                const wires = wireCode.split('');
                const wireCount = wires.length;

                // éªŒè¯çº¿è·¯æ•°é‡æ˜¯å¦ç¬¦åˆè¦æ±‚(3-6æ ¹)
                if (![3, 4, 5, 6].includes(wireCount)) {
                    return [0, 'æœªçŸ¥', 'çº¿è·¯æ•°é‡å¿…é¡»ä¸º3-6æ ¹'];
                }

                // ç»Ÿè®¡å„é¢œè‰²çº¿çš„æ•°é‡
                const redCount = wires.filter(w => w === '1').length;
                const yellowCount = wires.filter(w => w === '2').length;
                const blueCount = wires.filter(w => w === '3').length;
                const blackCount = wires.filter(w => w === '4').length;
                const whiteCount = wires.filter(w => w === '5').length;

                let cutIndex = 0; // è¦å‰ªæ–­çš„ç´¢å¼•(ä»0å¼€å§‹)

                // 3æ ¹çº¿çš„è§„åˆ™
                if (wireCount === 3) {
                    if (redCount === 0) {
                        cutIndex = 1; // ç¬¬äºŒæ ¹
                    } else {
                        if (wires[wires.length - 1] === '5') { // æœ€åä¸€æ ¹æ˜¯ç™½çº¿
                            cutIndex = 2;
                        } else if (blueCount > 1) { // ä¸æ­¢ä¸€æ ¹è“çº¿
                            // æ‰¾åˆ°æœ€åä¸€æ ¹è“çº¿çš„ç´¢å¼•
                            cutIndex = wires.lastIndexOf('3');
                        } else {
                            cutIndex = 2; // æœ€åä¸€æ ¹çº¿
                        }
                    }
                }

                // 4æ ¹çº¿çš„è§„åˆ™
                else if (wireCount === 4) {
                    if (redCount > 1 && serialLastDigit % 2 === 1) { // ä¸æ­¢ä¸€æ ¹çº¢çº¿ä¸”åºåˆ—å·æœ«ä½å¥‡æ•°
                        // æ‰¾åˆ°æœ€åä¸€æ ¹çº¢çº¿çš„ç´¢å¼•
                        cutIndex = wires.lastIndexOf('1');
                    } else if (redCount === 0 && wires[wires.length - 1] === '2') { // æ²¡æœ‰çº¢çº¿ä¸”æœ€åä¸€æ ¹æ˜¯é»„çº¿
                        cutIndex = 0; // ç¬¬ä¸€æ ¹
                    } else if (blueCount === 1) { // æœ‰ä¸”ä»…æœ‰ä¸€æ ¹è“çº¿
                        cutIndex = 0; // ç¬¬ä¸€æ ¹
                    } else if (yellowCount > 1) { // ä¸æ­¢ä¸€æ ¹é»„çº¿
                        cutIndex = 3; // æœ€åä¸€æ ¹
                    } else {
                        cutIndex = 1; // ç¬¬äºŒæ ¹
                    }
                }

                // 5æ ¹çº¿çš„è§„åˆ™
                else if (wireCount === 5) {
                    if (wires[wires.length - 1] === '4' && serialLastDigit % 2 === 1) { // æœ€åä¸€æ ¹æ˜¯é»‘çº¿ä¸”åºåˆ—å·æœ«ä½å¥‡æ•°
                        cutIndex = 3; // ç¬¬å››æ ¹
                    } else if (redCount === 1 && yellowCount > 1) { // ä»…æœ‰ä¸€æ ¹çº¢çº¿ä¸”é»„çº¿ä¸æ­¢ä¸€æ ¹
                        cutIndex = 0; // ç¬¬ä¸€æ ¹
                    } else if (blackCount === 0) { // æ²¡æœ‰é»‘çº¿
                        cutIndex = 1; // ç¬¬äºŒæ ¹
                    } else {
                        cutIndex = 0; // ç¬¬ä¸€æ ¹
                    }
                }

                // 6æ ¹çº¿çš„è§„åˆ™
                else if (wireCount === 6) {
                    if (yellowCount === 0 && serialLastDigit % 2 === 1) { // æ²¡æœ‰é»„çº¿ä¸”åºåˆ—å·æœ«ä½å¥‡æ•°
                        cutIndex = 2; // ç¬¬ä¸‰æ ¹
                    } else if (yellowCount === 1 && whiteCount > 1) { // ä»…æœ‰ä¸€æ ¹é»„çº¿ä¸”ç™½çº¿ä¸æ­¢ä¸€æ ¹
                        cutIndex = 3; // ç¬¬å››æ ¹
                    } else if (redCount === 0) { // æ²¡æœ‰çº¢çº¿
                        cutIndex = 5; // æœ€åä¸€æ ¹
                    } else {
                        cutIndex = 3; // ç¬¬å››æ ¹
                    }
                }

                // è®¡ç®—ä½ç½®ä¿¡æ¯
                const cutPosition = cutIndex + 1; // è½¬æ¢ä¸ºä»1å¼€å§‹çš„ä½ç½®
                const cutColor = colorMap[wires[cutIndex]];
                const positionDesc = positionDescMap[cutPosition];

                return [cutPosition, cutColor, positionDesc];
            }
        }

        // å¤æ‚çº¿è·¯æ¨¡å—
        class ComplexWiresModule {
            constructor() {
                this.state = {
                    led: null,
                    color: null,
                    star: null,
                    battery: null,
                    parallel: null
                };
                this.initialize();
            }

            initialize() {
                this.setupEventListeners();
                this.updateInstruction();
            }

            setupEventListeners() {
                // LEDç¯çŠ¶æ€æŒ‰é’®
                document.querySelectorAll('[data-led]').forEach(btn => {
                    btn.addEventListener('click', () => {
                        this.updateSelection('led', btn.getAttribute('data-led'), btn);
                    });
                });

                // çº¿è·¯é¢œè‰²æŒ‰é’®
                document.querySelectorAll('[data-color]').forEach(btn => {
                    btn.addEventListener('click', () => {
                        this.updateSelection('color', btn.getAttribute('data-color'), btn);
                    });
                });

                // â˜…æ ‡è®°æŒ‰é’®
                document.querySelectorAll('[data-star]').forEach(btn => {
                    btn.addEventListener('click', () => {
                        this.updateSelection('star', btn.getAttribute('data-star'), btn);
                    });
                });

                // ç”µæ± æ•°é‡æŒ‰é’®
                document.querySelectorAll('[data-battery]').forEach(btn => {
                    btn.addEventListener('click', () => {
                        this.updateSelection('battery', btn.getAttribute('data-battery'), btn);
                    });
                });

                // Parallelç«¯å£æŒ‰é’®
                document.querySelectorAll('[data-parallel]').forEach(btn => {
                    btn.addEventListener('click', () => {
                        this.updateSelection('parallel', btn.getAttribute('data-parallel'), btn);
                    });
                });

                // åºåˆ—å·è¾“å…¥
                document.getElementById('complex-serial-last').addEventListener('input', (e) => {
                    e.target.value = e.target.value.replace(/[^0-9]/g, '');
                    this.updateInstruction();
                });

                // æ¸…ç©ºæŒ‰é’®
                document.getElementById('clear-complex').addEventListener('click', () => {
                    this.reset();
                });

                // æ˜¾ç¤ºè§„åˆ™æŒ‰é’®
                document.getElementById('show-complex-rules').addEventListener('click', () => {
                    document.getElementById('complex-rules-modal').style.display = 'flex';
                });

                // å…³é—­è§„åˆ™æŒ‰é’®
                document.getElementById('close-complex-rules').addEventListener('click', () => {
                    document.getElementById('complex-rules-modal').style.display = 'none';
                });

                // ç‚¹å‡»æ¨¡æ€æ¡†èƒŒæ™¯å…³é—­
                document.getElementById('complex-rules-modal').addEventListener('click', (e) => {
                    if (e.target === document.getElementById('complex-rules-modal')) {
                        document.getElementById('complex-rules-modal').style.display = 'none';
                    }
                });
            }

            updateSelection(type, value, button) {
                // ç§»é™¤åŒç»„å…¶ä»–æŒ‰é’®çš„activeçŠ¶æ€
                document.querySelectorAll(`[data-${type}]`).forEach(btn => {
                    btn.classList.remove('active');
                });

                // æ·»åŠ å½“å‰æŒ‰é’®çš„activeçŠ¶æ€
                button.classList.add('active');

                // æ›´æ–°çŠ¶æ€
                this.state[type] = value;

                // æ›´æ–°æŒ‡ç¤º
                this.updateInstruction();
            }

            updateInstruction() {
                const instructionElement = document.getElementById('complex-instruction');
                const serialLast = document.getElementById('complex-serial-last').value;

                // æ£€æŸ¥æ˜¯å¦æœ‰è¶³å¤Ÿçš„ä¿¡æ¯æ¥ç”ŸæˆæŒ‡ç¤º
                if (!this.state.led || !this.state.color || this.state.star === null) {
                    instructionElement.innerHTML = `
                        <div class="text-center">
                            <p class="text-gray-400 italic">è¯·é€‰æ‹©LEDç¯çŠ¶æ€ã€çº¿è·¯é¢œè‰²å’Œâ˜…æ ‡è®°</p>
                        </div>
                    `;
                    return;
                }

                // æ£€æŸ¥åºåˆ—å·æ˜¯å¦å·²è¾“å…¥ï¼ˆå¦‚æœéœ€è¦ï¼‰
                if ((this.state.led === 'on' && this.state.color === 'white') ||
                    (this.state.led === 'off' && this.state.color === 'black' && this.state.star === 'yes')) {
                    if (!serialLast) {
                        instructionElement.innerHTML = `
                            <div class="text-center">
                                <p class="text-warning">è¯·è¾“å…¥åºåˆ—å·æœ«ä½æ•°å­—ä»¥è·å–å‡†ç¡®æŒ‡ç¤º</p>
                            </div>
                        `;
                        return;
                    }
                }

                // ç”Ÿæˆæ‹†é™¤æŒ‡ç¤º
                const shouldCut = this.shouldCutWire(serialLast ? parseInt(serialLast) : null);
                const action = shouldCut ? 'å‰ªæ–­è¯¥çº¿' : 'ä¸è¦å‰ªæ–­è¯¥çº¿';
                const color = this.getColorName(this.state.color);
                const ledStatus = this.state.led === 'on' ? 'äº®èµ·' : 'ç†„ç­';
                const starStatus = this.state.star === 'yes' ? 'æœ‰' : 'æ— ';

                instructionElement.innerHTML = `
                    <div>
                        <div style="background-color: #0f172a; padding: 1rem; border-radius: 8px; margin-bottom: 1rem;">
                            <p style="font-size: 1.125rem; font-weight: 600; color: ${shouldCut ? 'var(--success-color)' : 'var(--danger-color)'};">
                                ${shouldCut ? 'âœ… ' : 'âŒ '}${action}
                            </p>
                        </div>
                        
                        <div style="font-size: 0.875rem; color: var(--text-secondary);">
                            <p><strong>å½“å‰é€‰æ‹©:</strong></p>
                            <p>â€¢ LEDç¯çŠ¶æ€: ${ledStatus}</p>
                            <p>â€¢ çº¿è·¯é¢œè‰²: ${color}</p>
                            <p>â€¢ â˜…æ ‡è®°: ${starStatus}</p>
                            ${this.state.battery ? `<p>â€¢ ç”µæ± æ•°é‡: ${this.state.battery === '0' ? 'æ— ç”µæ± ' : this.state.battery === '1' ? '1ä¸ª' : '2ä¸ªæˆ–æ›´å¤š'}</p>` : ''}
                            ${this.state.parallel ? `<p>â€¢ Parallelç«¯å£: ${this.state.parallel === 'yes' ? 'æœ‰' : 'æ— '}</p>` : ''}
                        </div>
                    </div>
                `;
            }

            shouldCutWire(serialLastDigit) {
                const { led, color, star, battery, parallel } = this.state;

                // æ ¹æ®ç”¨æˆ·æä¾›çš„æ–°è§„åˆ™è¡¨è¿›è¡Œåˆ¤æ–­
                // äº®çº¢ç¯ç›¸å…³è§„åˆ™
                if (led === 'on' && color === 'red') {
                    // äº®çº¢ç¯ï¼Œä¸ç®¡æœ‰æ²¡æœ‰â˜…æ ‡è®°ï¼Œéƒ½æ˜¯Bç±»æŒ‡å¼•ï¼šç”µæ± â‰¥2å‰ªæ–­
                    return battery === '2'; // '2' è¡¨ç¤º2ä¸ªæˆ–æ›´å¤š
                }

                // äº®è“ç¯ç›¸å…³è§„åˆ™
                if (led === 'on' && color === 'blue') {
                    // äº®è“ç¯ï¼Œä¸ç®¡æœ‰æ²¡æœ‰â˜…æ ‡è®°ï¼Œéƒ½æ˜¯Pç±»æŒ‡å¼•ï¼šæœ‰Parallelå‰ªæ–­
                    return parallel === 'yes';
                }

                // äº®çº¢è“ç¯ç›¸å…³è§„åˆ™
                if (led === 'on' && color === 'red-blue') {
                    if (star === 'yes') {
                        // äº®çº¢è“ç¯æœ‰â˜…æ ‡è®°ï¼ŒDç±»æŒ‡å¼•ï¼šä¸å‰ª
                        return false;
                    } else {
                        // äº®çº¢è“ç¯æ— â˜…æ ‡è®°ï¼ŒSç±»æŒ‡å¼•ï¼šæœ«ä½å¶æ•°å‰ªæ–­
                        return serialLastDigit !== null && serialLastDigit % 2 === 0;
                    }
                }

                // äº®ç™½ç¯ç›¸å…³è§„åˆ™
                if (led === 'on' && color === 'white') {
                    if (star === 'yes') {
                        // äº®ç™½ç¯æœ‰â˜…æ ‡è®°ï¼ŒBç±»æŒ‡å¼•ï¼šç”µæ± â‰¥2å‰ªæ–­
                        return battery === '2';
                    } else {
                        // äº®ç™½ç¯æ— â˜…æ ‡è®°ï¼ŒDç±»æŒ‡å¼•ï¼šä¸å‰ª
                        return false;
                    }
                }

                // ç­çº¢ç¯ç›¸å…³è§„åˆ™
                if (led === 'off' && color === 'red') {
                    if (star === 'yes') {
                        // ç­çº¢ç¯æœ‰â˜…æ ‡è®°ï¼ŒCç±»æŒ‡å¼•ï¼šå‰ªæ–­
                        return true;
                    } else {
                        // ç­çº¢ç¯æ— â˜…æ ‡è®°ï¼ŒSç±»æŒ‡å¼•ï¼šæœ«ä½å¶æ•°å‰ªæ–­
                        return serialLastDigit !== null && serialLastDigit % 2 === 0;
                    }
                }

                // ç­è“ç¯ç›¸å…³è§„åˆ™
                if (led === 'off' && color === 'blue') {
                    if (star === 'yes') {
                        // ç­è“ç¯æœ‰â˜…æ ‡è®°ï¼ŒDç±»æŒ‡å¼•ï¼šä¸å‰ª
                        return false;
                    } else {
                        // ç­è“ç¯æ— â˜…æ ‡è®°ï¼ŒSç±»æŒ‡å¼•ï¼šæœ«ä½å¶æ•°å‰ªæ–­
                        return serialLastDigit !== null && serialLastDigit % 2 === 0;
                    }
                }

                // ç­çº¢è“ç¯ç›¸å…³è§„åˆ™
                if (led === 'off' && color === 'red-blue') {
                    if (star === 'yes') {
                        // ç­çº¢è“ç¯æœ‰â˜…æ ‡è®°ï¼ŒPç±»æŒ‡å¼•ï¼šæœ‰Parallelå‰ªæ–­
                        return parallel === 'yes';
                    } else {
                        // ç­çº¢è“ç¯æ— â˜…æ ‡è®°ï¼ŒSç±»æŒ‡å¼•ï¼šæœ«ä½å¶æ•°å‰ªæ–­
                        return serialLastDigit !== null && serialLastDigit % 2 === 0;
                    }
                }

                // ç­ç™½ç¯ç›¸å…³è§„åˆ™
                if (led === 'off' && color === 'white') {
                    // ç­ç™½ç¯ï¼Œä¸ç®¡æœ‰æ²¡æœ‰â˜…æ ‡è®°ï¼Œéƒ½æ˜¯Cç±»æŒ‡å¼•ï¼šå‰ªæ–­
                    return true;
                }

                // é»˜è®¤æƒ…å†µï¼Œä¸å‰ªæ–­
                return false;
            }

            getColorName(colorCode) {
                const colorNames = {
                    'red': 'çº¢è‰²',
                    'blue': 'è“è‰²',
                    'red-blue': 'çº¢è“ï¼ˆä¸¤è‰²ï¼‰',
                    'white': 'ç™½è‰²'
                };
                return colorNames[colorCode] || colorCode;
            }

            reset() {
                // é‡ç½®çŠ¶æ€
                this.state = {
                    led: null,
                    color: null,
                    star: null,
                    battery: null,
                    parallel: null
                };

                // ç§»é™¤æ‰€æœ‰æŒ‰é’®çš„activeçŠ¶æ€
                document.querySelectorAll('.feature-btn').forEach(btn => {
                    btn.classList.remove('active');
                });

                // ä¿ç•™åºåˆ—å·æœ«ä½ï¼Œä¸æ¸…ç©º
                // document.getElementById('complex-serial-last').value = '';

                // æ›´æ–°æŒ‡ç¤º
                this.updateInstruction();
            }
        }

        // è®°å¿†æ¨¡å—
        class MemoryModule {
            constructor() {
                this.currentStage = 1;
                this.currentDisplay = null;
                this.stageHistory = [];
                this.initialize();
            }

            initialize() {
                this.setupEventListeners();
                this.updateInstruction();
                this.updateStageIndicator();
            }

            setupEventListeners() {
                // æ˜¾ç¤ºæ•°å­—æŒ‰é’®
                document.querySelectorAll('[data-display]').forEach(btn => {
                    btn.addEventListener('click', () => {
                        this.setDisplay(parseInt(btn.getAttribute('data-display')), btn);
                    });
                });

                // æ•°å­—æŒ‰é’®
                document.querySelectorAll('.number-btn').forEach(btn => {
                    btn.addEventListener('click', () => {
                        this.handleNumberButtonClick(parseInt(btn.getAttribute('data-number')), btn);
                    });
                });

                // ä½ç½®æŒ‰é’®
                document.querySelectorAll('.position-btn').forEach(btn => {
                    btn.addEventListener('click', () => {
                        this.handlePositionButtonClick(parseInt(btn.getAttribute('data-position')), btn);
                    });
                });

                // é‡ç½®æŒ‰é’®
                document.getElementById('reset-memory').addEventListener('click', () => {
                    this.reset();
                });

                // æ˜¾ç¤ºè§„åˆ™æŒ‰é’®
                document.getElementById('show-memory-rules').addEventListener('click', () => {
                    document.getElementById('memory-rules-modal').style.display = 'flex';
                });

                // å…³é—­è§„åˆ™æŒ‰é’®
                document.getElementById('close-memory-rules').addEventListener('click', () => {
                    document.getElementById('memory-rules-modal').style.display = 'none';
                });

                // ç‚¹å‡»æ¨¡æ€æ¡†èƒŒæ™¯å…³é—­
                document.getElementById('memory-rules-modal').addEventListener('click', (e) => {
                    if (e.target === document.getElementById('memory-rules-modal')) {
                        document.getElementById('memory-rules-modal').style.display = 'none';
                    }
                });
            }

            setDisplay(displayNumber, button) {
                // ç§»é™¤æ‰€æœ‰æŒ‰é’®çš„é€‰ä¸­çŠ¶æ€
                document.querySelectorAll('[data-display]').forEach(btn => {
                    btn.classList.remove('active');
                });
                document.querySelectorAll('.number-btn').forEach(btn => {
                    btn.classList.remove('selected');
                });
                document.querySelectorAll('.position-btn').forEach(btn => {
                    btn.classList.remove('selected');
                });

                // æ·»åŠ å½“å‰æŒ‰é’®çš„activeçŠ¶æ€
                button.classList.add('active');

                this.currentDisplay = displayNumber;
                this.selectedNumber = null;
                this.selectedPosition = null;

                // æ›´æ–°æ“ä½œæŒ‡ç¤º
                this.updateInstruction();

                // è‡ªåŠ¨é€‰ä¸­å¯¹åº”çš„æŒ‰é’®
                this.autoSelectButton();
            }

            autoSelectButton() {
                if (!this.currentDisplay) return;

                // è·å–åº”è¯¥æŒ‰çš„ä½ç½®å’Œæ•°å­—
                const shouldPressPosition = this.getCorrectButtonPosition(this.currentDisplay);
                const shouldPressNumber = this.getButtonNumberAtPosition(shouldPressPosition);

                // åˆ¤æ–­å½“å‰é˜¶æ®µéœ€è¦æŒ‰ä½ç½®è¿˜æ˜¯æ•°å­—
                let actionType = 'ä½ç½®';
                let actionValue = shouldPressPosition;

                // æ ¹æ®é˜¶æ®µå’Œè§„åˆ™ç¡®å®šæ“ä½œç±»å‹
                if (this.currentStage === 2 && this.currentDisplay === 1) {
                    actionType = 'æ•°å­—';
                    actionValue = shouldPressNumber;
                } else if (this.currentStage === 3 && (this.currentDisplay === 1 || this.currentDisplay === 2)) {
                    actionType = 'æ•°å­—';
                    actionValue = shouldPressNumber;
                } else if (this.currentStage === 5) {
                    // ç¬¬äº”é˜¶æ®µéœ€è¦æŒ‰æ•°å­—
                    actionType = 'æ•°å­—';

                    // æ ¹æ®ç¬¬äº”é˜¶æ®µè§„åˆ™è·å–åº”è¯¥æŒ‰çš„æ•°å­—
                    const stage1History = this.stageHistory.find(h => h.stage === 1);
                    const stage2History = this.stageHistory.find(h => h.stage === 2);
                    const stage3History = this.stageHistory.find(h => h.stage === 3);
                    const stage4History = this.stageHistory.find(h => h.stage === 4);

                    switch (this.currentDisplay) {
                        case 1:
                            actionValue = stage1History ? stage1History.pressedNumber : 0;
                            break;
                        case 2:
                            actionValue = stage2History ? stage2History.pressedNumber : 0;
                            break;
                        case 3:
                            actionValue = stage4History ? stage4History.pressedNumber : 0;
                            break;
                        case 4:
                            actionValue = stage3History ? stage3History.pressedNumber : 0;
                            break;
                        default:
                            actionValue = 0;
                    }
                }

                // è‡ªåŠ¨é€‰ä¸­å¯¹åº”çš„æŒ‰é’®
                if (actionType === 'æ•°å­—' && actionValue > 0) {
                    const numberButton = document.querySelector(`.number-btn[data-number="${actionValue}"]`);
                    if (numberButton) {
                        numberButton.classList.add('selected');
                        this.selectedNumber = actionValue;
                    }
                } else if (actionType === 'ä½ç½®' && actionValue > 0) {
                    const positionButton = document.querySelector(`.position-btn[data-position="${actionValue}"]`);
                    if (positionButton) {
                        positionButton.classList.add('selected');
                        this.selectedPosition = actionValue;
                    }
                }
            }

            handleNumberButtonClick(number, button) {
                if (!this.currentDisplay) {
                    alert('è¯·å…ˆé€‰æ‹©æ˜¾ç¤ºçš„æ•°å­—');
                    return;
                }

                // æ£€æŸ¥æ˜¯å¦ç‚¹å‡»çš„æ˜¯å·²é€‰ä¸­çš„æŒ‰é’®
                if (button.classList.contains('selected')) {
                    // å–æ¶ˆé€‰ä¸­
                    button.classList.remove('selected');
                    this.selectedNumber = null;
                } else {
                    // ç§»é™¤å…¶ä»–æ•°å­—æŒ‰é’®çš„é€‰ä¸­çŠ¶æ€
                    document.querySelectorAll('.number-btn').forEach(btn => {
                        btn.classList.remove('selected');
                    });

                    // æ·»åŠ å½“å‰æŒ‰é’®çš„é€‰ä¸­çŠ¶æ€
                    button.classList.add('selected');

                    // æ›´æ–°é€‰ä¸­çš„æ•°å­—
                    this.selectedNumber = number;

                    // æ£€æŸ¥æ˜¯å¦å·²ç»é€‰æ‹©äº†ä½ç½®
                    this.checkCompleteSelection();
                }
            }

            handlePositionButtonClick(position, button) {
                if (!this.currentDisplay) {
                    alert('è¯·å…ˆé€‰æ‹©æ˜¾ç¤ºçš„æ•°å­—');
                    return;
                }

                // æ£€æŸ¥æ˜¯å¦ç‚¹å‡»çš„æ˜¯å·²é€‰ä¸­çš„æŒ‰é’®
                if (button.classList.contains('selected')) {
                    // å–æ¶ˆé€‰ä¸­
                    button.classList.remove('selected');
                    this.selectedPosition = null;
                } else {
                    // ç§»é™¤å…¶ä»–ä½ç½®æŒ‰é’®çš„é€‰ä¸­çŠ¶æ€
                    document.querySelectorAll('.position-btn').forEach(btn => {
                        btn.classList.remove('selected');
                    });

                    // æ·»åŠ å½“å‰æŒ‰é’®çš„é€‰ä¸­çŠ¶æ€
                    button.classList.add('selected');

                    // æ›´æ–°é€‰ä¸­çš„ä½ç½®
                    this.selectedPosition = position;

                    // æ£€æŸ¥æ˜¯å¦å·²ç»é€‰æ‹©äº†æ•°å­—
                    this.checkCompleteSelection();
                }
            }

            checkCompleteSelection() {
                // åªæœ‰å½“æ•°å­—å’Œä½ç½®éƒ½é€‰æ‹©äº†ï¼Œæ‰å®Œæˆä¸€æ¬¡è®°å½•
                if (this.selectedNumber !== null && this.selectedPosition !== null) {
                    this.processCompleteSelection();
                }
            }

            processCompleteSelection() {
                // è®°å½•é˜¶æ®µå†å²ï¼ˆä¸è¿›è¡Œæ­£ç¡®æ€§éªŒè¯ï¼‰
                this.stageHistory.push({
                    stage: this.currentStage,
                    display: this.currentDisplay,
                    pressedPosition: this.selectedPosition,
                    pressedNumber: this.selectedNumber,
                    isCorrect: true // é»˜è®¤éƒ½è§†ä¸ºæ­£ç¡®
                });

                // æ›´æ–°UI
                this.updateStageDisplay();

                // è·å–é€‰ä¸­çš„æŒ‰é’®å¹¶æ˜¾ç¤ºæˆåŠŸçŠ¶æ€
                const numberButton = document.querySelector(`.number-btn[data-number="${this.selectedNumber}"]`);
                const positionButton = document.querySelector(`.position-btn[data-position="${this.selectedPosition}"]`);

                // æ˜¾ç¤ºæˆåŠŸçŠ¶æ€
                if (numberButton) numberButton.classList.add('correct');
                if (positionButton) positionButton.classList.add('correct');

                setTimeout(() => {
                    if (numberButton) numberButton.classList.remove('correct', 'selected');
                    if (positionButton) positionButton.classList.remove('correct', 'selected');
                }, 1000);

                // è¿›å…¥ä¸‹ä¸€é˜¶æ®µæˆ–å®Œæˆ
                setTimeout(() => {
                    if (this.currentStage < 5) {
                        this.nextStage();
                    } else {
                        this.complete();
                    }
                }, 1000);

                // é‡ç½®é€‰æ‹©çŠ¶æ€
                this.selectedNumber = null;
                this.selectedPosition = null;
            }

            getCorrectButtonPosition(displayNumber) {
                switch (this.currentStage) {
                    case 1:
                        return this.getStage1Position(displayNumber);
                    case 2:
                        return this.getStage2Position(displayNumber);
                    case 3:
                        return this.getStage3Position(displayNumber);
                    case 4:
                        return this.getStage4Position(displayNumber);
                    case 5:
                        return this.getStage5Position(displayNumber);
                    default:
                        return 0;
                }
            }

            getStage1Position(displayNumber) {
                switch (displayNumber) {
                    case 1: return 2;
                    case 2: return 2;
                    case 3: return 3;
                    case 4: return 4;
                    default: return 0;
                }
            }

            getStage2Position(displayNumber) {
                const stage1History = this.stageHistory.find(h => h.stage === 1);
                const stage1Position = stage1History ? stage1History.pressedPosition : 0;

                switch (displayNumber) {
                    case 1: return this.getPositionByNumber(4);
                    case 2: return stage1Position;
                    case 3: return 1;
                    case 4: return stage1Position;
                    default: return 0;
                }
            }

            getStage3Position(displayNumber) {
                const stage1History = this.stageHistory.find(h => h.stage === 1);
                const stage2History = this.stageHistory.find(h => h.stage === 2);
                const stage1Number = stage1History ? stage1History.pressedNumber : 0;
                const stage2Number = stage2History ? stage2History.pressedNumber : 0;

                switch (displayNumber) {
                    case 1: return this.getPositionByNumber(stage2Number);
                    case 2: return this.getPositionByNumber(stage1Number);
                    case 3: return 3;
                    case 4: return this.getPositionByNumber(4);
                    default: return 0;
                }
            }

            getStage4Position(displayNumber) {
                const stage1History = this.stageHistory.find(h => h.stage === 1);
                const stage2History = this.stageHistory.find(h => h.stage === 2);
                const stage1Position = stage1History ? stage1History.pressedPosition : 0;
                const stage2Position = stage2History ? stage2History.pressedPosition : 0;

                switch (displayNumber) {
                    case 1: return stage1Position;
                    case 2: return 1;
                    case 3: return stage2Position;
                    case 4: return stage2Position;
                    default: return 0;
                }
            }

            getStage5Position(displayNumber) {
                const stage1History = this.stageHistory.find(h => h.stage === 1);
                const stage2History = this.stageHistory.find(h => h.stage === 2);
                const stage3History = this.stageHistory.find(h => h.stage === 3);
                const stage4History = this.stageHistory.find(h => h.stage === 4);
                const stage1Number = stage1History ? stage1History.pressedNumber : 0;
                const stage2Number = stage2History ? stage2History.pressedNumber : 0;
                const stage3Number = stage3History ? stage3History.pressedNumber : 0;
                const stage4Number = stage4History ? stage4History.pressedNumber : 0;

                switch (displayNumber) {
                    case 1: return this.getPositionByNumber(stage1Number);
                    case 2: return this.getPositionByNumber(stage2Number);
                    case 3: return this.getPositionByNumber(stage4Number);
                    case 4: return this.getPositionByNumber(stage3Number);
                    default: return 0;
                }
            }

            getPositionByNumber(targetNumber) {
                // æŒ‰é’®å¸ƒå±€ï¼šä½ç½®1-4ï¼Œæ¯è¡Œ4ä¸ªæŒ‰é’®
                const buttonLayout = [
                    { position: 1, number: 1 },
                    { position: 2, number: 2 },
                    { position: 3, number: 3 },
                    { position: 4, number: 4 },
                    { position: 1, number: 2 },
                    { position: 2, number: 1 },
                    { position: 3, number: 4 },
                    { position: 4, number: 3 }
                ];

                const button = buttonLayout.find(b => b.number === targetNumber);
                return button ? button.position : 0;
            }

            nextStage() {
                this.currentStage++;
                this.currentDisplay = null;

                // æ¸…é™¤æ˜¾ç¤ºæ•°å­—æŒ‰é’®çš„activeçŠ¶æ€
                document.querySelectorAll('[data-display]').forEach(btn => {
                    btn.classList.remove('active');
                });

                this.updateStageIndicator();
                this.updateInstruction();
            }

            resetToStage1() {
                this.currentStage = 1;
                this.currentDisplay = null;
                this.selectedNumber = null;
                this.selectedPosition = null;
                this.stageHistory = [];

                // å®Œå…¨é‡ç½®æ‰€æœ‰æŒ‰é’®æ ·å¼
                document.querySelectorAll('[data-display]').forEach(btn => {
                    btn.className = 'feature-btn';
                });

                document.querySelectorAll('.memory-btn').forEach(btn => {
                    btn.className = btn.classList.contains('number-btn') ? 'memory-btn number-btn' : 'memory-btn position-btn';
                });

                // æ¸…ç©ºé˜¶æ®µè®°å½•
                for (let i = 1; i <= 5; i++) {
                    const displayInput = document.getElementById(`stage-${i}-display`);
                    const buttonInput = document.getElementById(`stage-${i}-button`);
                    const positionInput = document.getElementById(`stage-${i}-position`);
                    if (displayInput) displayInput.value = '';
                    if (buttonInput) buttonInput.value = '';
                    if (positionInput) positionInput.value = '';
                }

                this.updateStageIndicator();
                this.updateInstruction();
            }

            updateStageDisplay() {
                this.stageHistory.forEach(history => {
                    const stage = history.stage;
                    document.getElementById(`stage-${stage}-display`).value = history.display;
                    document.getElementById(`stage-${stage}-button`).value = history.pressedNumber;
                    document.getElementById(`stage-${stage}-position`).value = history.pressedPosition;
                });
            }

            updateStageIndicator() {
                document.getElementById('current-stage').textContent = this.currentStage;
            }

            updateInstruction() {
                const instructionElement = document.getElementById('memory-instruction');

                if (!this.currentDisplay) {
                    instructionElement.innerHTML = `
                        <div class="text-center">
                            <p class="text-gray-400 italic">è¯·é€‰æ‹©å½“å‰é˜¶æ®µæ˜¾ç¤ºçš„æ•°å­—</p>
                            <p class="text-sm mt-2">å½“å‰é˜¶æ®µ: ${this.currentStage}</p>
                        </div>
                    `;
                    return;
                }

                // æ ¹æ®å½“å‰é˜¶æ®µå’Œæ˜¾ç¤ºæ•°å­—ç”ŸæˆæŒ‡ç¤º
                const shouldPressPosition = this.getCorrectButtonPosition(this.currentDisplay);
                const shouldPressNumber = this.getButtonNumberAtPosition(shouldPressPosition);

                // åˆ¤æ–­å½“å‰é˜¶æ®µéœ€è¦æŒ‰ä½ç½®è¿˜æ˜¯æ•°å­—
                let actionType = 'ä½ç½®';
                let actionValue = shouldPressPosition;

                // æ ¹æ®é˜¶æ®µå’Œè§„åˆ™ç¡®å®šæ“ä½œç±»å‹
                if (this.currentStage === 2 && this.currentDisplay === 1) {
                    actionType = 'æ•°å­—';
                    actionValue = shouldPressNumber;
                } else if (this.currentStage === 3 && (this.currentDisplay === 1 || this.currentDisplay === 2)) {
                    actionType = 'æ•°å­—';
                    actionValue = shouldPressNumber;
                } else if (this.currentStage === 5) {
                    // ç¬¬äº”é˜¶æ®µéœ€è¦æŒ‰æ•°å­—
                    actionType = 'æ•°å­—';

                    // æ ¹æ®ç¬¬äº”é˜¶æ®µè§„åˆ™è·å–åº”è¯¥æŒ‰çš„æ•°å­—
                    const stage1History = this.stageHistory.find(h => h.stage === 1);
                    const stage2History = this.stageHistory.find(h => h.stage === 2);
                    const stage3History = this.stageHistory.find(h => h.stage === 3);
                    const stage4History = this.stageHistory.find(h => h.stage === 4);

                    switch (this.currentDisplay) {
                        case 1:
                            actionValue = stage1History ? stage1History.pressedNumber : 0;
                            break;
                        case 2:
                            actionValue = stage2History ? stage2History.pressedNumber : 0;
                            break;
                        case 3:
                            actionValue = stage4History ? stage4History.pressedNumber : 0;
                            break;
                        case 4:
                            actionValue = stage3History ? stage3History.pressedNumber : 0;
                            break;
                        default:
                            actionValue = 0;
                    }
                }

                instructionElement.innerHTML = `
                    <div>
                        <div style="background-color: #0f172a; padding: 1rem; border-radius: 8px;">
                            <p style="font-size: 1.125rem; font-weight: 600; color: var(--warning-color);">
                                é˜¶æ®µ ${this.currentStage} - æ˜¾ç¤ºæ•°å­—: ${this.currentDisplay}
                            </p>
                            <p style="font-size: 1.25rem; font-weight: 700; color: var(--success-color); margin-top: 0.5rem;">
                                åº”è¯¥æŒ‰ä¸‹: ${actionType} ${actionValue}
                            </p>
                        </div>
                    </div>
                `;
            }

            getButtonNumberAtPosition(position) {
                // æŒ‰é’®å¸ƒå±€æ˜ å°„
                const positionToNumberMap = {
                    1: [1, 2], // ä½ç½®1æœ‰ä¸¤ä¸ªæŒ‰é’®ï¼šæ•°å­—1å’Œ2
                    2: [2, 1], // ä½ç½®2æœ‰ä¸¤ä¸ªæŒ‰é’®ï¼šæ•°å­—2å’Œ1
                    3: [3, 4], // ä½ç½®3æœ‰ä¸¤ä¸ªæŒ‰é’®ï¼šæ•°å­—3å’Œ4
                    4: [4, 3]  // ä½ç½®4æœ‰ä¸¤ä¸ªæŒ‰é’®ï¼šæ•°å­—4å’Œ3
                };

                // æ ¹æ®å½“å‰é˜¶æ®µé€‰æ‹©æ­£ç¡®çš„æ•°å­—
                // è¿™é‡Œç®€åŒ–å¤„ç†ï¼Œè¿”å›ç¬¬ä¸€ä¸ªåŒ¹é…çš„æ•°å­—
                return positionToNumberMap[position] ? positionToNumberMap[position][0] : 0;
            }

            complete() {
                const instructionElement = document.getElementById('memory-instruction');
                instructionElement.innerHTML = `
                    <div class="text-center">
                        <div style="font-size: 3rem; margin-bottom: 1rem;">ğŸ‰</div>
                        <p style="font-size: 1.5rem; font-weight: 700; color: var(--success-color);">
                            æ­å–œï¼è®°å¿†æ¨¡å—å·²æˆåŠŸè§£é™¤ï¼
                        </p>
                        <p class="text-sm mt-2">æ‰€æœ‰5ä¸ªé˜¶æ®µéƒ½å·²å®Œæˆ</p>
                    </div>
                `;

                // ç¦ç”¨æ‰€æœ‰æŒ‰é’®
                document.querySelectorAll('[data-display], .memory-btn').forEach(btn => {
                    btn.disabled = true;
                    btn.classList.add('opacity-50', 'cursor-not-allowed');
                });
            }

            reset() {
                this.currentStage = 1;
                this.currentDisplay = null;
                this.stageHistory = [];

                // æ¸…é™¤æ‰€æœ‰çŠ¶æ€
                document.querySelectorAll('[data-display], .memory-btn').forEach(btn => {
                    btn.classList.remove('active', 'correct', 'incorrect', 'opacity-50', 'cursor-not-allowed');
                    btn.disabled = false;
                });

                // æ¸…ç©ºé˜¶æ®µè®°å½•
                for (let i = 1; i <= 5; i++) {
                    document.getElementById(`stage-${i}-display`).value = '';
                    document.getElementById(`stage-${i}-button`).value = '';
                    document.getElementById(`stage-${i}-position`).value = '';
                }

                this.updateStageIndicator();
                this.updateInstruction();
            }
        }

        // é¡ºåºçº¿è·¯ç±»
        class SequenceModule {
            constructor() {
                this.sequence = [];
                this.counts = {
                    red: 0,
                    blue: 0,
                    black: 0
                };
                this.init();
            }

            init() {
                this.updateSequenceDisplay();
                this.updateHighlighting();
                this.updateInstruction();
            }

            addColor(color) {
                this.sequence.push(color);
                this.counts[color]++;
                this.updateSequenceDisplay();
                this.updateHighlighting();
                this.updateInstruction();
            }

            updateSequenceDisplay() {
                const sequenceList = document.getElementById('sequence-list');
                sequenceList.innerHTML = '';

                this.sequence.forEach((color, index) => {
                    const item = document.createElement('div');
                    item.className = `sequence-item ${color}`;
                    item.innerHTML = `
                        <span class="item-number">#${index + 1}</span>
                        <span class="item-color">${this.getColorName(color)}</span>
                    `;
                    sequenceList.appendChild(item);
                });
            }

            updateHighlighting() {
                // ç§»é™¤æ‰€æœ‰é«˜äº®
                document.querySelectorAll('.sequence-table tr').forEach(row => {
                    row.classList.remove('highlight', 'highlight-red', 'highlight-blue', 'highlight-black');
                });

                // æ·»åŠ æ–°çš„é«˜äº®
                const rows = document.querySelectorAll('.sequence-table tbody tr');

                // é«˜äº®çº¢è‰²å¯¹åº”çš„è¡Œ
                if (this.counts.red > 0 && this.counts.red <= 9) {
                    const row = rows[this.counts.red - 1];
                    row.classList.add('highlight-red');
                }

                // é«˜äº®è“è‰²å¯¹åº”çš„è¡Œ
                if (this.counts.blue > 0 && this.counts.blue <= 9) {
                    const row = rows[this.counts.blue - 1];
                    row.classList.add('highlight-blue');
                }

                // é«˜äº®é»‘è‰²å¯¹åº”çš„è¡Œ
                if (this.counts.black > 0 && this.counts.black <= 9) {
                    const row = rows[this.counts.black - 1];
                    row.classList.add('highlight-black');
                }
            }

            updateInstruction() {
                const instruction = document.getElementById('sequence-instruction');
                if (this.sequence.length === 0) {
                    instruction.textContent = 'è¯·ç‚¹å‡»ä¸Šæ–¹é¢œè‰²æŒ‰é’®æ¥è®°å½•å‡ºç°çš„çº¿æ¡é¡ºåºï¼Œç³»ç»Ÿå°†è‡ªåŠ¨é«˜äº®å¯¹åº”çš„å‰ªæ–­æŒ‡å¼•ã€‚';
                } else {
                    const lastColor = this.sequence[this.sequence.length - 1];
                    const count = this.counts[lastColor];
                    const action = this.getActionForColor(lastColor, count);
                    instruction.innerHTML = `
                        <strong>ç¬¬${this.sequence.length}æ­¥ï¼š</strong>
                        å‡ºç°äº†ç¬¬${count}æ ¹${this.getColorName(lastColor)}çº¿ï¼Œ
                        è¯·å‰ªæ–­ <span class="text-success font-bold">${action}</span>ã€‚
                    `;
                }
            }

            getActionForColor(color, count) {
                const actions = {
                    red: ['C', 'B', 'A', 'Aæˆ–C', 'B', 'Aæˆ–C', 'Aã€Bæˆ–C', 'Aæˆ–B', 'B'],
                    blue: ['B', 'Aæˆ–C', 'B', 'A', 'B', 'Bæˆ–C', 'C', 'Aæˆ–C', 'A'],
                    black: ['Aã€Bæˆ–C', 'Aæˆ–C', 'B', 'Aæˆ–C', 'B', 'Bæˆ–C', 'Aæˆ–B', 'C', 'C']
                };
                return actions[color][count - 1] || 'æœªçŸ¥';
            }

            getColorName(color) {
                const names = {
                    red: 'çº¢',
                    blue: 'è“',
                    black: 'é»‘'
                };
                return names[color] || color;
            }

            reset() {
                this.sequence = [];
                this.counts = {
                    red: 0,
                    blue: 0,
                    black: 0
                };
                this.init();
            }
        }

        class PasswordModule {
            constructor() {
                this.words = [
                    'about', 'after', 'again', 'below', 'could',
                    'every', 'first', 'found', 'great', 'house',
                    'large', 'learn', 'never', 'other', 'place',
                    'plant', 'point', 'right', 'small', 'sound',
                    'spell', 'still', 'study', 'their', 'there',
                    'these', 'thing', 'think', 'three', 'water',
                    'where', 'which', 'world', 'would', 'write'
                ];
                this.availableLetters = ['', '', '', '', ''];
                this.init();
            }

            init() {
                this.bindEvents();
                this.updatePossibleWords();
            }

            bindEvents() {
                // ç»‘å®šè¾“å…¥æ¡†äº‹ä»¶
                for (let i = 0; i < 5; i++) {
                    const input = document.getElementById(`letters-${i}`);
                    if (input) {
                        input.addEventListener('input', (e) => {
                            this.availableLetters[i] = e.target.value.toUpperCase();
                            this.updatePossibleWords();
                        });
                    }
                }

                // ç»‘å®šé‡ç½®æŒ‰é’®
                const resetBtn = document.getElementById('reset-password');
                if (resetBtn) {
                    resetBtn.addEventListener('click', () => this.reset());
                }

                // ç»‘å®šå¸®åŠ©æŒ‰é’®
                const helpBtn = document.getElementById('show-password-help');
                if (helpBtn) {
                    helpBtn.addEventListener('click', () => {
                        document.getElementById('password-rules-modal').style.display = 'flex';
                    });
                }

                // ç»‘å®šæ¨¡æ€æ¡†å…³é—­æŒ‰é’®
                const closeBtn = document.getElementById('close-password-rules');
                if (closeBtn) {
                    closeBtn.addEventListener('click', () => {
                        document.getElementById('password-rules-modal').style.display = 'none';
                    });
                }
            }

            updatePossibleWords() {
                const possibleWords = this.words.filter(word => {
                    for (let i = 0; i < 5; i++) {
                        const available = this.availableLetters[i].toLowerCase();
                        if (available && !available.includes(word[i])) {
                            return false;
                        }
                    }
                    return true;
                });

                const wordsList = document.getElementById('words-list');
                if (wordsList) {
                    if (possibleWords.length === 0) {
                        wordsList.innerHTML = '<span class="text-danger">æ²¡æœ‰æ‰¾åˆ°åŒ¹é…çš„å•è¯</span>';
                    } else {
                        wordsList.innerHTML = possibleWords.map(word =>
                            `<span class="word-item">${word}</span>`
                        ).join('');
                    }
                }

                // æ›´æ–°æç¤ºä¿¡æ¯
                const hint = document.getElementById('password-hint');
                if (hint) {
                    if (possibleWords.length === 1) {
                        hint.innerHTML = `<span class="text-success">å”¯ä¸€å¯èƒ½çš„å•è¯: ${possibleWords[0]}</span>`;
                    } else if (possibleWords.length > 0) {
                        hint.innerHTML = `æ‰¾åˆ° ${possibleWords.length} ä¸ªå¯èƒ½çš„å•è¯ï¼Œè¯·ç»§ç»­è¾“å…¥æ›´å¤šé™åˆ¶æ¡ä»¶`;
                    } else {
                        hint.innerHTML = '<span class="text-danger">æ²¡æœ‰æ‰¾åˆ°åŒ¹é…çš„å•è¯ï¼Œè¯·æ£€æŸ¥è¾“å…¥çš„å­—æ¯</span>';
                    }
                }
            }

            reset() {
                // é‡ç½®è¾“å…¥æ¡†
                this.availableLetters = ['', '', '', '', ''];
                for (let i = 0; i < 5; i++) {
                    const input = document.getElementById(`letters-${i}`);
                    if (input) {
                        input.value = '';
                    }
                }

                // é‡ç½®æç¤ºä¿¡æ¯
                const hint = document.getElementById('password-hint');
                if (hint) {
                    hint.innerHTML = 'è¯·è¾“å…¥æ¯ä¸ªä½ç½®çš„å¯é€‰å­—æ¯ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨æ˜¾ç¤ºå¯èƒ½çš„å•è¯';
                }

                // é‡ç½®å•è¯åˆ—è¡¨
                this.updatePossibleWords();
            }
        }

        // å¤åˆ¶åˆ°å‰ªè´´æ¿å‡½æ•°
        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                // æ˜¾ç¤ºå¤åˆ¶æˆåŠŸæç¤º
                const toast = document.createElement('div');
                toast.textContent = `âœ“ å·²å¤åˆ¶: ${text}`;
                toast.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    padding: 12px 24px;
                    background-color: var(--success-color);
                    color: white;
                    border-radius: 8px;
                    z-index: 10000;
                    font-weight: 600;
                    animation: fadeIn 0.3s ease;
                `;
                document.body.appendChild(toast);
                setTimeout(() => {
                    toast.style.animation = 'fadeOut 0.3s ease';
                    setTimeout(() => {
                        document.body.removeChild(toast);
                    }, 300);
                }, 2000);
            });
        }



        // åˆå§‹åŒ–åº”ç”¨
        document.addEventListener('DOMContentLoaded', () => {
            setupModuleSwitching();

            // åˆå§‹åŒ–å„ä¸ªæ¨¡å—
            modules.wires = new WiresModule();
            modules.complexWires = new ComplexWiresModule();
            modules.sequence = new SequenceModule();
            modules.memory = new MemoryModule();
            modules.password = new PasswordModule();

            // ç»‘å®šé¡ºåºçº¿è·¯æ¨¡å—æŒ‰é’®äº‹ä»¶
            document.getElementById('show-sequence-rules').addEventListener('click', () => {
                document.getElementById('sequence-rules-modal').style.display = 'flex';
            });
            document.getElementById('reset-sequence-module').addEventListener('click', resetSequenceModule);
        });
    </script>

</body>

</html>